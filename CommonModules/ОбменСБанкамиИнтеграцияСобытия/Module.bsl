////////////////////////////////////////////////////////////////////////////////
// ОбменСБанкамиИнтеграцияСобытия: механизм обмена электронными документами с банками.
//
////////////////////////////////////////////////////////////////////////////////
 
#Область СлужебныеПроцедурыИФункции

Процедура СоздатьОписаниеОповещенияОНовыхПисьмах(Оповещения)
	
	ИмяОповещения = ОбменСБанкамиСлужебныйКлиентСервер.ИмяОповещенияОНовыхПисьмах();
	Оповещение = СерверныеОповещения.НовоеСерверноеОповещение(ИмяОповещения);
	Оповещение.ИмяМодуляПолучения = "ОбменСБанкамиИнтеграцияКлиентСобытия";
	Оповещения.Вставить(Оповещение.Имя, Оповещение);
	
КонецПроцедуры 

Процедура СоздатьОписаниеОповещенияОНепрочитанныхПисьмах(Оповещения)
	
	ИмяОповещения = ОбменСБанкамиСлужебныйКлиентСервер.ИмяОповещенияОНепрочитанныхПисьмах();
	Оповещение = СерверныеОповещения.НовоеСерверноеОповещение(ИмяОповещения);
	Оповещение.ИмяМодуляОтправки = "ОбменСБанкамиСлужебный";
	ПериодПроверкиВСекундах = 60*60*12;
	Оповещение.Вставить("ПериодПроверки", ПериодПроверкиВСекундах);
	Оповещение.ИмяМодуляПолучения = "ОбменСБанкамиИнтеграцияКлиентСобытия";
	Оповещения.Вставить(Оповещение.Имя, Оповещение);

КонецПроцедуры

Процедура СоздатьОписаниеОповещенияОНеотправленныхПисьмах(Оповещения)
	
	ИмяОповещения = ОбменСБанкамиСлужебныйКлиентСервер.ИмяОповещенияОНеотправленныхПисьмах();   
	Оповещение = СерверныеОповещения.НовоеСерверноеОповещение(ИмяОповещения); 
	Оповещение.ИмяМодуляОтправки = "ОбменСБанкамиСлужебный";
	ПериодПроверкиВСекундах = 60*60*12;
	Оповещение.Вставить("ПериодПроверки", ПериодПроверкиВСекундах);
	Оповещение.ИмяМодуляПолучения = "ОбменСБанкамиИнтеграцияКлиентСобытия"; 
	Оповещения.Вставить(Оповещение.Имя, Оповещение);
	
КонецПроцедуры

Процедура СоздатьОписаниеОповещенияОбОтклоненныхДокументах(Оповещения)
	
	ИмяОповещения = ОбменСБанкамиСлужебныйКлиентСервер.ИмяОповещенияОбОтклоненныхДокументах();
	Оповещение = СерверныеОповещения.НовоеСерверноеОповещение(ИмяОповещения);
	Оповещение.ИмяМодуляОтправки = "ОбменСБанкамиСлужебный";
	ПериодПроверкиВСекундах = 600;
	Оповещение.Вставить("ПериодПроверки", ПериодПроверкиВСекундах);
	Оповещение.ИмяМодуляПолучения = "ОбменСБанкамиИнтеграцияКлиентСобытия";
	Оповещения.Вставить(Оповещение.Имя, Оповещение);
	
КонецПроцедуры

// См. ОбщегоНазначенияПереопределяемый.ПриДобавленииСерверныхОповещений
//
Процедура ПриДобавленииСерверныхОповещений(Оповещения) Экспорт
	
	Если Не ОбщегоНазначенияБЭД.ДоступныСерверныеОповещения() Тогда
		Возврат;
	КонецЕсли;
	
	СостояниеОбменаСБанками = ОбменСБанкамиСлужебный.ТекущееСостояниеОбменаСБанками();
	
	Если Не СостояниеОбменаСБанками.ЕстьПравоЧтенияДанных Тогда
		Возврат;
	КонецЕсли;
	
	Если Не СостояниеОбменаСБанками.ИспользуетсяОбменСБанками Тогда
		Возврат;
	КонецЕсли;
	
	Если СостояниеОбменаСБанками.ПисьмаОбменСБанкамиЕстьНастройка 
		И СостояниеОбменаСБанками.ЕстьПравоОбработкиПисем Тогда
		
		СоздатьОписаниеОповещенияОНовыхПисьмах(Оповещения);
		СоздатьОписаниеОповещенияОНепрочитанныхПисьмах(Оповещения);
		СоздатьОписаниеОповещенияОНеотправленныхПисьмах(Оповещения);
		
	КонецЕсли;
	
	Если СостояниеОбменаСБанками.ПоддержкаСессииОбменСБанкамиЕстьНастройка Тогда
		СоздатьОписаниеОповещенияОбОтклоненныхДокументах(Оповещения);
	КонецЕсли;
	
КонецПроцедуры

 #КонецОбласти