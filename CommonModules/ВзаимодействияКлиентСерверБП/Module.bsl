
#Область СлужебныйПрограммныйИнтерфейс

Функция Кому() Экспорт
	Возврат "Кому";
КонецФункции

Функция Копия() Экспорт
	Возврат "Копия";
КонецФункции

Функция СкрытаяКопия() Экспорт
	Возврат "СкрытаяКопия";
КонецФункции

Процедура ОбработкаПолученияПолейПредставления(МенеджерОбъекта, Поля, СтандартнаяОбработка) Экспорт
	
	Поля.Добавить("Тема");
	Поля.Добавить("Дата");
	СтандартнаяОбработка = Ложь;
	
КонецПроцедуры

Процедура ОбработкаПолученияПредставления(МенеджерОбъекта, Данные, Представление, СтандартнаяОбработка) Экспорт
	
	Дата = Формат(Данные.Дата, "ДФ='dd MMMM yyyy HH:mm';");
	Тема = Данные.Тема;
	ВидВзаимодействия = "";
	
	ТипОбъекта = ТипЗнч(МенеджерОбъекта);
	Если ТипОбъекта = Тип("ДокументМенеджер.Встреча") Тогда
		ВидВзаимодействия = НСтр("ru = 'Встреча'");
	ИначеЕсли ТипОбъекта = Тип("ДокументМенеджер.ТелефонныйЗвонок") Тогда
		ВидВзаимодействия = НСтр("ru = 'Звонок'");
	ИначеЕсли ТипОбъекта = Тип("ДокументМенеджер.ЭлектронноеПисьмоВходящее") Тогда
		ВидВзаимодействия = НСтр("ru = 'Входящее письмо'");
	ИначеЕсли ТипОбъекта = Тип("ДокументМенеджер.ЭлектронноеПисьмоИсходящее") Тогда
		ВидВзаимодействия = НСтр("ru = 'Исходящее письмо'");
	КонецЕсли;
	
	ШаблонПредставления = НСтр("ru = '%1 от %2 (%3)'");
	Представление = СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(
		ШаблонПредставления, ВидВзаимодействия, Дата, Тема);
	
	СтандартнаяОбработка = Ложь;
	 
КонецПроцедуры

#КонецОбласти
