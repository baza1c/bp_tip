#Область СлужебныйПрограммныйИнтерфейс

Функция ВерсияФорматаДанных() Экспорт
	
	Возврат "1.0.1";
	
КонецФункции

Функция ОписаниеТиповОрганизация() Экспорт
	
	Возврат Метаданные.ОпределяемыеТипы.Организация.Тип;
	
КонецФункции

Процедура ПриПолученииДанныхСинхронизируемыхОбъектов(ТипСсылки, МенеджерВТ, ИсточникДанных, ПоляДанныхОбъекта) Экспорт
	
	Если ТипСсылки = Тип("ДокументСсылка.ПриходныйКассовыйОрдер") Тогда
		
		Запрос = Новый Запрос(
		"ВЫБРАТЬ
		|	ТаблицаИдентификаторы.ПубличныйИдентификатор КАК ПубличныйИдентификатор,
		|	ТаблицаИдентификаторы.Идентификатор КАК Идентификатор,
		|	ТаблицаИдентификаторы.Ссылка КАК Ссылка,
		|	Т.ПометкаУдаления КАК ПометкаУдаления,
		|	Т.Проведен КАК Проведен,
		|	Т.Номер КАК Номер,
		|	Т.Дата КАК Дата,
		|	ПРЕДСТАВЛЕНИЕ(Т.ВидОперации) КАК ВидОперации,
		|	Т.СуммаДокумента КАК СуммаДокумента,
		|	ПРЕДСТАВЛЕНИЕ(МАКСИМУМ(Т.Ссылка)) КАК Представление,
		|	""Деньги"" КАК РазделУчета,
		|	Т.Организация КАК Организация,
		|	Т.ДеятельностьНаПатенте КАК ДеятельностьНаПатенте,
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(Т.Контрагент) КАК Контрагент_GUID,
		|	Т.Контрагент.ОбособленноеПодразделение КАК Контрагент_ОбособленноеПодразделение,
		|	СУММА(ЕСТЬNULL(ТЧ1.СуммаНДС, 0)) КАК СуммаНДС
		|ИЗ
		|	ТаблицаИдентификаторы КАК ТаблицаИдентификаторы
		|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ПриходныйКассовыйОрдер КАК Т
		|			ЛЕВОЕ СОЕДИНЕНИЕ Документ.ПриходныйКассовыйОрдер.РасшифровкаПлатежа КАК ТЧ1
		|			ПО Т.Ссылка = ТЧ1.Ссылка
		|		ПО (Т.Ссылка = ТаблицаИдентификаторы.Ссылка)
		|
		|СГРУППИРОВАТЬ ПО
		|	ТаблицаИдентификаторы.ПубличныйИдентификатор,
		|	ТаблицаИдентификаторы.Идентификатор,
		|	ТаблицаИдентификаторы.Ссылка,
		|	Т.ПометкаУдаления,
		|	Т.Проведен,
		|	Т.Номер,
		|	Т.Дата,
		|	Т.СуммаДокумента,
		|	Т.Организация,
		|	Т.ДеятельностьНаПатенте,
		|	Т.Контрагент.ОбособленноеПодразделение,
		|	ПРЕДСТАВЛЕНИЕ(Т.ВидОперации),
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(Т.Контрагент)");
		Запрос.МенеджерВременныхТаблиц = МенеджерВТ;
		
		ИсточникДанных = Запрос.Выполнить();
		ПоляДанныхОбъекта = "ДеятельностьНаПатенте,Контрагент_GUID,Контрагент_ОбособленноеПодразделение,СуммаНДС";
		
	ИначеЕсли ТипСсылки = Тип("ДокументСсылка.РасходныйКассовыйОрдер") Тогда
		
		Запрос = Новый Запрос(
		"ВЫБРАТЬ
		|	ТаблицаИдентификаторы.ПубличныйИдентификатор КАК ПубличныйИдентификатор,
		|	ТаблицаИдентификаторы.Идентификатор КАК Идентификатор,
		|	ТаблицаИдентификаторы.Ссылка КАК Ссылка,
		|	Т.ПометкаУдаления КАК ПометкаУдаления,
		|	Т.Проведен КАК Проведен,
		|	Т.Номер КАК Номер,
		|	Т.Дата КАК Дата,
		|	ПРЕДСТАВЛЕНИЕ(Т.ВидОперации) КАК ВидОперации,
		|	Т.СуммаДокумента КАК СуммаДокумента,
		|	ПРЕДСТАВЛЕНИЕ(МАКСИМУМ(Т.Ссылка)) КАК Представление,
		|	""Деньги"" КАК РазделУчета,
		|	Т.Организация КАК Организация,
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(Т.Контрагент) КАК Контрагент_GUID,
		|	Т.НомерВходящегоДокумента КАК НомерВходящегоДокумента,
		|	Т.Контрагент.ОбособленноеПодразделение КАК Контрагент_ОбособленноеПодразделение,
		|	СУММА(ЕСТЬNULL(ТЧ1.СуммаНДС, 0)) КАК СуммаНДС
		|ИЗ
		|	ТаблицаИдентификаторы КАК ТаблицаИдентификаторы
		|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.РасходныйКассовыйОрдер КАК Т
		|			ЛЕВОЕ СОЕДИНЕНИЕ Документ.РасходныйКассовыйОрдер.РасшифровкаПлатежа КАК ТЧ1
		|			ПО Т.Ссылка = ТЧ1.Ссылка
		|		ПО (Т.Ссылка = ТаблицаИдентификаторы.Ссылка)
		|
		|СГРУППИРОВАТЬ ПО
		|	ТаблицаИдентификаторы.ПубличныйИдентификатор,
		|	ТаблицаИдентификаторы.Идентификатор,
		|	ТаблицаИдентификаторы.Ссылка,
		|	Т.ПометкаУдаления,
		|	Т.Проведен,
		|	Т.Номер,
		|	Т.Дата,
		|	Т.НомерВходящегоДокумента,
		|	Т.СуммаДокумента,
		|	Т.Организация,
		|	Т.Контрагент.ОбособленноеПодразделение,
		|	ПРЕДСТАВЛЕНИЕ(Т.ВидОперации),
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(Т.Контрагент)");
		Запрос.МенеджерВременныхТаблиц = МенеджерВТ;
		
		ИсточникДанных = Запрос.Выполнить();
		ПоляДанныхОбъекта = "Контрагент_GUID,Контрагент_ОбособленноеПодразделение,НомерВходящегоДокумента,СуммаНДС";
		
	ИначеЕсли ТипСсылки = Тип("ДокументСсылка.ПоступлениеНаРасчетныйСчет") Тогда
		
		Запрос = Новый Запрос(
		"ВЫБРАТЬ
		|	ТаблицаИдентификаторы.ПубличныйИдентификатор КАК ПубличныйИдентификатор,
		|	ТаблицаИдентификаторы.Идентификатор КАК Идентификатор,
		|	ТаблицаИдентификаторы.Ссылка КАК Ссылка,
		|	Т.ПометкаУдаления КАК ПометкаУдаления,
		|	Т.Проведен КАК Проведен,
		|	Т.Номер КАК Номер,
		|	Т.Дата КАК Дата,
		|	ПРЕДСТАВЛЕНИЕ(Т.ВидОперации) КАК ВидОперации,
		|	Т.СуммаДокумента КАК СуммаДокумента,
		|	ПРЕДСТАВЛЕНИЕ(МАКСИМУМ(Т.Ссылка)) КАК Представление,
		|	""Деньги"" КАК РазделУчета,
		|	Т.Организация КАК Организация,
		|	ВЫБОР
		|		КОГДА Т.Патент = ЗНАЧЕНИЕ(Справочник.Патенты.Пустаяссылка)
		|			ТОГДА ЛОЖЬ
		|		ИНАЧЕ ИСТИНА
		|	КОНЕЦ КАК ДеятельностьНаПатенте,
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(Т.Контрагент) КАК Контрагент_GUID,
		|	Т.НомерВходящегоДокумента КАК НомерВходящегоДокумента,
		|	Т.ДатаВходящегоДокумента КАК ДатаВходящегоДокумента,
		|	Т.Контрагент.ОбособленноеПодразделение КАК Контрагент_ОбособленноеПодразделение,
		|	СУММА(ЕСТЬNULL(ТЧ1.СуммаНДС, 0)) КАК СуммаНДС
		|ИЗ
		|	ТаблицаИдентификаторы КАК ТаблицаИдентификаторы
		|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ПоступлениеНаРасчетныйСчет КАК Т
		|			ЛЕВОЕ СОЕДИНЕНИЕ Документ.ПоступлениеНаРасчетныйСчет.РасшифровкаПлатежа КАК ТЧ1
		|			ПО Т.Ссылка = ТЧ1.Ссылка
		|		ПО (Т.Ссылка = ТаблицаИдентификаторы.Ссылка)
		|
		|СГРУППИРОВАТЬ ПО
		|	ТаблицаИдентификаторы.ПубличныйИдентификатор,
		|	ТаблицаИдентификаторы.Идентификатор,
		|	ТаблицаИдентификаторы.Ссылка,
		|	Т.ПометкаУдаления,
		|	Т.Проведен,
		|	Т.Номер,
		|	Т.Дата,
		|	Т.СуммаДокумента,
		|	Т.Организация,
		|	Т.НомерВходящегоДокумента,
		|	Т.ДатаВходящегоДокумента,
		|	Т.Контрагент.ОбособленноеПодразделение,
		|	ВЫБОР
		|		КОГДА Т.Патент = ЗНАЧЕНИЕ(Справочник.Патенты.Пустаяссылка)
		|			ТОГДА ЛОЖЬ
		|		ИНАЧЕ ИСТИНА
		|	КОНЕЦ,
		|	ПРЕДСТАВЛЕНИЕ(Т.ВидОперации),
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(Т.Контрагент)");
		Запрос.МенеджерВременныхТаблиц = МенеджерВТ;
		
		ИсточникДанных = Запрос.Выполнить();
		ПоляДанныхОбъекта = "ДеятельностьНаПатенте,Контрагент_GUID,Контрагент_ОбособленноеПодразделение,НомерВходящегоДокумента,ДатаВходящегоДокумента,СуммаНДС";
		
	ИначеЕсли ТипСсылки = Тип("ДокументСсылка.СписаниеСРасчетногоСчета") Тогда
		
		Запрос = Новый Запрос(
		"ВЫБРАТЬ
		|	ТаблицаИдентификаторы.ПубличныйИдентификатор КАК ПубличныйИдентификатор,
		|	ТаблицаИдентификаторы.Идентификатор КАК Идентификатор,
		|	ТаблицаИдентификаторы.Ссылка КАК Ссылка,
		|	Т.ПометкаУдаления КАК ПометкаУдаления,
		|	Т.Проведен КАК Проведен,
		|	Т.Номер КАК Номер,
		|	Т.Дата КАК Дата,
		|	ПРЕДСТАВЛЕНИЕ(Т.ВидОперации) КАК ВидОперации,
		|	Т.СуммаДокумента КАК СуммаДокумента,
		|	ПРЕДСТАВЛЕНИЕ(МАКСИМУМ(Т.Ссылка)) КАК Представление,
		|	""Деньги"" КАК РазделУчета,
		|	Т.Организация КАК Организация,
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(Т.Контрагент) КАК Контрагент_GUID,
		|	Т.НомерВходящегоДокумента КАК НомерВходящегоДокумента,
		|	Т.ДатаВходящегоДокумента КАК ДатаВходящегоДокумента,
		|	Т.Контрагент.ОбособленноеПодразделение КАК Контрагент_ОбособленноеПодразделение,
		|	СУММА(ЕСТЬNULL(ТЧ1.СуммаНДС, 0)) КАК СуммаНДС
		|ИЗ
		|	ТаблицаИдентификаторы КАК ТаблицаИдентификаторы
		|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.СписаниеСРасчетногоСчета КАК Т
		|			ЛЕВОЕ СОЕДИНЕНИЕ Документ.СписаниеСРасчетногоСчета.РасшифровкаПлатежа КАК ТЧ1
		|			ПО Т.Ссылка = ТЧ1.Ссылка
		|		ПО (Т.Ссылка = ТаблицаИдентификаторы.Ссылка)
		|
		|СГРУППИРОВАТЬ ПО
		|	ТаблицаИдентификаторы.ПубличныйИдентификатор,
		|	ТаблицаИдентификаторы.Идентификатор,
		|	ТаблицаИдентификаторы.Ссылка,
		|	Т.ПометкаУдаления,
		|	Т.Проведен,
		|	Т.Номер,
		|	Т.Дата,
		|	Т.СуммаДокумента,
		|	Т.Организация,
		|	Т.НомерВходящегоДокумента,
		|	Т.ДатаВходящегоДокумента,
		|	Т.Контрагент.ОбособленноеПодразделение,
		|	ПРЕДСТАВЛЕНИЕ(Т.ВидОперации),
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(Т.Контрагент)");
		Запрос.МенеджерВременныхТаблиц = МенеджерВТ;
		
		ИсточникДанных = Запрос.Выполнить();
		ПоляДанныхОбъекта = "Контрагент_GUID,Контрагент_ОбособленноеПодразделение,НомерВходящегоДокумента,ДатаВходящегоДокумента,СуммаНДС";
		
	ИначеЕсли ТипСсылки = Тип("ДокументСсылка.ПлатежноеПоручение") Тогда
		
		Запрос = Новый Запрос(
		"ВЫБРАТЬ
		// Обязательные поля запроса.
		|	ТаблицаИдентификаторы.ПубличныйИдентификатор КАК ПубличныйИдентификатор,
		|	ТаблицаИдентификаторы.Идентификатор КАК Идентификатор,
		|	ТаблицаИдентификаторы.Ссылка КАК Ссылка,
		|	Т.ПометкаУдаления КАК ПометкаУдаления,
		|	Т.Проведен КАК Проведен,
		|	Т.Номер КАК Номер,
		|	Т.Дата КАК Дата,
		|	ПРЕДСТАВЛЕНИЕ(Т.ВидОперации) КАК ВидОперации,
		|	Т.СуммаДокумента КАК СуммаДокумента,
		|	ПРЕДСТАВЛЕНИЕ(Т.Ссылка) КАК Представление,
		|	""Деньги"" КАК РазделУчета,
		|	Т.Организация КАК Организация,	
		// Дополнительные поля данных объекта.
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(Т.Контрагент) КАК Контрагент_GUID,
		|	Т.Контрагент.ОбособленноеПодразделение КАК Контрагент_ОбособленноеПодразделение,
		|	Т.СуммаНДС КАК СуммаНДС
		|ИЗ
		|	ТаблицаИдентификаторы КАК ТаблицаИдентификаторы
		|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ПлатежноеПоручение КАК Т
		|		ПО (Т.Ссылка = ТаблицаИдентификаторы.Ссылка)");
		Запрос.МенеджерВременныхТаблиц = МенеджерВТ;
		
		ИсточникДанных = Запрос.Выполнить();
		ПоляДанныхОбъекта = "Контрагент_GUID,Контрагент_ОбособленноеПодразделение,СуммаНДС";
		
	ИначеЕсли ТипСсылки = Тип("ДокументСсылка.ОплатаПлатежнойКартой") Тогда
		
		Запрос = Новый Запрос(
		"ВЫБРАТЬ
		|	ТаблицаИдентификаторы.ПубличныйИдентификатор КАК ПубличныйИдентификатор,
		|	ТаблицаИдентификаторы.Идентификатор КАК Идентификатор,
		|	ТаблицаИдентификаторы.Ссылка КАК Ссылка,
		|	Т.ПометкаУдаления КАК ПометкаУдаления,
		|	Т.Проведен КАК Проведен,
		|	Т.Номер КАК Номер,
		|	Т.Дата КАК Дата,
		|	ПРЕДСТАВЛЕНИЕ(Т.ВидОперации) КАК ВидОперации,
		|	Т.СуммаДокумента КАК СуммаДокумента,
		|	ПРЕДСТАВЛЕНИЕ(МАКСИМУМ(Т.Ссылка)) КАК Представление,
		|	""Деньги"" КАК РазделУчета,
		|	Т.Организация КАК Организация,
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(Т.Контрагент) КАК Контрагент_GUID,
		|	Т.НомерВходящегоДокумента КАК НомерВходящегоДокумента,
		|	Т.ДатаВходящегоДокумента КАК ДатаВходящегоДокумента,
		|	Т.Контрагент.ОбособленноеПодразделение КАК Контрагент_ОбособленноеПодразделение,
		|	СУММА(ЕСТЬNULL(ТЧ1.СуммаНДС, 0)) КАК СуммаНДС
		|ИЗ
		|	ТаблицаИдентификаторы КАК ТаблицаИдентификаторы
		|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ОплатаПлатежнойКартой КАК Т
		|			ЛЕВОЕ СОЕДИНЕНИЕ Документ.ОплатаПлатежнойКартой.РасшифровкаПлатежа КАК ТЧ1
		|			ПО Т.Ссылка = ТЧ1.Ссылка
		|		ПО (Т.Ссылка = ТаблицаИдентификаторы.Ссылка)
		|
		|СГРУППИРОВАТЬ ПО
		|	ТаблицаИдентификаторы.ПубличныйИдентификатор,
		|	ТаблицаИдентификаторы.Идентификатор,
		|	ТаблицаИдентификаторы.Ссылка,
		|	Т.ПометкаУдаления,
		|	Т.Проведен,
		|	Т.Номер,
		|	Т.Дата,
		|	Т.СуммаДокумента,
		|	Т.Организация,
		|	Т.НомерВходящегоДокумента,
		|	Т.ДатаВходящегоДокумента,
		|	Т.Контрагент.ОбособленноеПодразделение,
		|	ПРЕДСТАВЛЕНИЕ(Т.ВидОперации),
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(Т.Контрагент)");
		Запрос.МенеджерВременныхТаблиц = МенеджерВТ;
		
		ИсточникДанных = Запрос.Выполнить();
		ПоляДанныхОбъекта = "Контрагент_GUID,Контрагент_ОбособленноеПодразделение,НомерВходящегоДокумента,ДатаВходящегоДокумента,СуммаНДС";
		
	ИначеЕсли ТипСсылки = Тип("ДокументСсылка.АвансовыйОтчет") Тогда
		
		Запрос = Новый Запрос(
		"ВЫБРАТЬ
		|	ТаблицаИдентификаторы.Ссылка КАК Ссылка,
		|	АвансовыйОтчетТовары.СуммаНДС КАК СуммаНДС
		|ПОМЕСТИТЬ СуммыДокументов
		|ИЗ
		|	ТаблицаИдентификаторы КАК ТаблицаИдентификаторы
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.АвансовыйОтчет.Товары КАК АвансовыйОтчетТовары
		|		ПО ТаблицаИдентификаторы.Ссылка = АвансовыйОтчетТовары.Ссылка
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ТаблицаИдентификаторы.Ссылка,
		|	АвансовыйОтчетПрочее.СуммаНДС
		|ИЗ
		|	ТаблицаИдентификаторы КАК ТаблицаИдентификаторы
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.АвансовыйОтчет.Прочее КАК АвансовыйОтчетПрочее
		|		ПО ТаблицаИдентификаторы.Ссылка = АвансовыйОтчетПрочее.Ссылка
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ТаблицаИдентификаторы.Ссылка,
		|	АвансовыйОтчетБилеты.СуммаНДС
		|ИЗ
		|	ТаблицаИдентификаторы КАК ТаблицаИдентификаторы
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.АвансовыйОтчет.Билеты КАК АвансовыйОтчетБилеты
		|		ПО ТаблицаИдентификаторы.Ссылка = АвансовыйОтчетБилеты.Ссылка
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ТаблицаИдентификаторы.ПубличныйИдентификатор КАК ПубличныйИдентификатор,
		|	ТаблицаИдентификаторы.Идентификатор КАК Идентификатор,
		|	ТаблицаИдентификаторы.Ссылка КАК Ссылка,
		|	АвансовыйОтчет.ПометкаУдаления КАК ПометкаУдаления,
		|	АвансовыйОтчет.Проведен КАК Проведен,
		|	АвансовыйОтчет.Номер КАК Номер,
		|	АвансовыйОтчет.Дата КАК Дата,
		|	ПРЕДСТАВЛЕНИЕ(АвансовыйОтчет.ВидОперации) КАК ВидОперации,
		|	АвансовыйОтчет.СуммаДокумента КАК СуммаДокумента,
		|	ПРЕДСТАВЛЕНИЕ(АвансовыйОтчет.Ссылка) КАК Представление,
		|	""Продажи"" КАК РазделУчета,
		|	АвансовыйОтчет.Организация КАК Организация,
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(АвансовыйОтчет.Склад) КАК Склад_GUID,
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(АвансовыйОтчет.ФизЛицо) КАК ФизЛицо_GUID,
		|	СУММА(ЕСТЬNULL(СуммыДокументов.СуммаНДС, 0)) КАК СуммаНДС
		|ИЗ
		|	ТаблицаИдентификаторы КАК ТаблицаИдентификаторы
		|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.АвансовыйОтчет КАК АвансовыйОтчет
		|		ПО (АвансовыйОтчет.Ссылка = ТаблицаИдентификаторы.Ссылка)
		|		ЛЕВОЕ СОЕДИНЕНИЕ СуммыДокументов КАК СуммыДокументов
		|		ПО (СуммыДокументов.Ссылка = ТаблицаИдентификаторы.Ссылка)
		|
		|СГРУППИРОВАТЬ ПО
		|	ТаблицаИдентификаторы.ПубличныйИдентификатор,
		|	ТаблицаИдентификаторы.Идентификатор,
		|	ТаблицаИдентификаторы.Ссылка,
		|	АвансовыйОтчет.ПометкаУдаления,
		|	АвансовыйОтчет.Проведен,
		|	АвансовыйОтчет.Номер,
		|	АвансовыйОтчет.Дата,
		|	АвансовыйОтчет.СуммаДокумента,
		|	АвансовыйОтчет.Организация,
		|	ПРЕДСТАВЛЕНИЕ(АвансовыйОтчет.ВидОперации),
		|	ПРЕДСТАВЛЕНИЕ(АвансовыйОтчет.Ссылка),
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(АвансовыйОтчет.Склад),
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(АвансовыйОтчет.ФизЛицо)");
		Запрос.МенеджерВременныхТаблиц = МенеджерВТ;
		
		ИсточникДанных = Запрос.Выполнить();
		ПоляДанныхОбъекта = "Склад_GUID,ФизЛицо_GUID,СуммаНДС";
		
	ИначеЕсли ТипСсылки = Тип("ДокументСсылка.СчетНаОплатуПокупателю") Тогда
		
		Запрос = Новый Запрос(
		"ВЫБРАТЬ
		|	ТаблицаИдентификаторы.ПубличныйИдентификатор КАК ПубличныйИдентификатор,
		|	ТаблицаИдентификаторы.Идентификатор КАК Идентификатор,
		|	ТаблицаИдентификаторы.Ссылка КАК Ссылка,
		|	Т.ПометкаУдаления КАК ПометкаУдаления,
		|	Т.Проведен КАК Проведен,
		|	Т.Номер КАК Номер,
		|	Т.Дата КАК Дата,
		|	ПРЕДСТАВЛЕНИЕ(Т.ВидОперации) КАК ВидОперации,
		|	Т.СуммаДокумента КАК СуммаДокумента,
		|	ПРЕДСТАВЛЕНИЕ(МАКСИМУМ(Т.Ссылка)) КАК Представление,
		|	""Продажи"" КАК РазделУчета,
		|	Т.Организация КАК Организация,
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(Т.Контрагент) КАК Контрагент_GUID,
		|	Т.Контрагент.ОбособленноеПодразделение КАК Контрагент_ОбособленноеПодразделение,
		|	СУММА(ЕСТЬNULL(ТЧ1.СуммаНДС, 0)) КАК СуммаНДС
		|ИЗ
		|	ТаблицаИдентификаторы КАК ТаблицаИдентификаторы
		|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.СчетНаОплатуПокупателю КАК Т
		|			ЛЕВОЕ СОЕДИНЕНИЕ Документ.СчетНаОплатуПокупателю.Товары КАК ТЧ1
		|			ПО Т.Ссылка = ТЧ1.Ссылка
		|		ПО (Т.Ссылка = ТаблицаИдентификаторы.Ссылка)
		|
		|СГРУППИРОВАТЬ ПО
		|	ТаблицаИдентификаторы.ПубличныйИдентификатор,
		|	ТаблицаИдентификаторы.Идентификатор,
		|	ТаблицаИдентификаторы.Ссылка,
		|	Т.ПометкаУдаления,
		|	Т.Проведен,
		|	Т.Номер,
		|	Т.Дата,
		|	Т.СуммаДокумента,
		|	Т.Организация,
		|	Т.Контрагент.ОбособленноеПодразделение,
		|	ПРЕДСТАВЛЕНИЕ(Т.ВидОперации),
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(Т.Контрагент)");
		Запрос.МенеджерВременныхТаблиц = МенеджерВТ;
		
		ИсточникДанных = Запрос.Выполнить();
		ПоляДанныхОбъекта = "Контрагент_GUID,Контрагент_ОбособленноеПодразделение,СуммаНДС";
		
	ИначеЕсли ТипСсылки = Тип("ДокументСсылка.РеализацияТоваровУслуг") Тогда
		
		Запрос = Новый Запрос(
		"ВЫБРАТЬ
		|	ТаблицаИдентификаторы.Ссылка КАК Ссылка,
		|	РеализацияТоваровУслугТовары.СуммаНДС КАК СуммаНДС
		|ПОМЕСТИТЬ СуммыДокументов
		|ИЗ
		|	ТаблицаИдентификаторы КАК ТаблицаИдентификаторы
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг.Товары КАК РеализацияТоваровУслугТовары
		|		ПО ТаблицаИдентификаторы.Ссылка = РеализацияТоваровУслугТовары.Ссылка
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ТаблицаИдентификаторы.Ссылка,
		|	РеализацияТоваровУслугУслуги.СуммаНДС
		|ИЗ
		|	ТаблицаИдентификаторы КАК ТаблицаИдентификаторы
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг.Услуги КАК РеализацияТоваровУслугУслуги
		|		ПО ТаблицаИдентификаторы.Ссылка = РеализацияТоваровУслугУслуги.Ссылка
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ТаблицаИдентификаторы.Ссылка,
		|	РеализацияТоваровУслугАгентскиеУслуги.СуммаНДС
		|ИЗ
		|	ТаблицаИдентификаторы КАК ТаблицаИдентификаторы
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг.АгентскиеУслуги КАК РеализацияТоваровУслугАгентскиеУслуги
		|		ПО ТаблицаИдентификаторы.Ссылка = РеализацияТоваровУслугАгентскиеУслуги.Ссылка
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ТаблицаИдентификаторы.ПубличныйИдентификатор КАК ПубличныйИдентификатор,
		|	ТаблицаИдентификаторы.Идентификатор КАК Идентификатор,
		|	ТаблицаИдентификаторы.Ссылка КАК Ссылка,
		|	РеализацияТоваровУслуг.ПометкаУдаления КАК ПометкаУдаления,
		|	РеализацияТоваровУслуг.Проведен КАК Проведен,
		|	РеализацияТоваровУслуг.Номер КАК Номер,
		|	РеализацияТоваровУслуг.Дата КАК Дата,
		|	ПРЕДСТАВЛЕНИЕ(РеализацияТоваровУслуг.ВидОперации) КАК ВидОперации,
		|	РеализацияТоваровУслуг.СуммаДокумента КАК СуммаДокумента,
		|	ПРЕДСТАВЛЕНИЕ(РеализацияТоваровУслуг.Ссылка) КАК Представление,
		|	""Продажи"" КАК РазделУчета,
		|	РеализацияТоваровУслуг.Организация КАК Организация,
		|	РеализацияТоваровУслуг.ДеятельностьНаПатенте КАК ДеятельностьНаПатенте,
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(РеализацияТоваровУслуг.Контрагент) КАК Контрагент_GUID,
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(РеализацияТоваровУслуг.Склад) КАК Склад_GUID,
		|	РеализацияТоваровУслуг.Контрагент.ОбособленноеПодразделение КАК Контрагент_ОбособленноеПодразделение,
		|	СУММА(ЕСТЬNULL(СуммыДокументов.СуммаНДС, 0)) КАК СуммаНДС
		|ИЗ
		|	ТаблицаИдентификаторы КАК ТаблицаИдентификаторы
		|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг КАК РеализацияТоваровУслуг
		|		ПО (РеализацияТоваровУслуг.Ссылка = ТаблицаИдентификаторы.Ссылка)
		|		ЛЕВОЕ СОЕДИНЕНИЕ СуммыДокументов КАК СуммыДокументов
		|		ПО (СуммыДокументов.Ссылка = ТаблицаИдентификаторы.Ссылка)
		|
		|СГРУППИРОВАТЬ ПО
		|	ТаблицаИдентификаторы.ПубличныйИдентификатор,
		|	ТаблицаИдентификаторы.Идентификатор,
		|	ТаблицаИдентификаторы.Ссылка,
		|	РеализацияТоваровУслуг.ПометкаУдаления,
		|	РеализацияТоваровУслуг.Проведен,
		|	РеализацияТоваровУслуг.Номер,
		|	РеализацияТоваровУслуг.Дата,
		|	РеализацияТоваровУслуг.СуммаДокумента,
		|	РеализацияТоваровУслуг.Организация,
		|	РеализацияТоваровУслуг.ДеятельностьНаПатенте,
		|	РеализацияТоваровУслуг.Контрагент.ОбособленноеПодразделение,
		|	ПРЕДСТАВЛЕНИЕ(РеализацияТоваровУслуг.ВидОперации),
		|	ПРЕДСТАВЛЕНИЕ(РеализацияТоваровУслуг.Ссылка),
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(РеализацияТоваровУслуг.Контрагент),
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(РеализацияТоваровУслуг.Склад)");
		Запрос.МенеджерВременныхТаблиц = МенеджерВТ;
		
		ИсточникДанных = Запрос.Выполнить();
		ПоляДанныхОбъекта = "ДеятельностьНаПатенте,Контрагент_GUID,Склад_GUID,Контрагент_ОбособленноеПодразделение,СуммаНДС";
		
	ИначеЕсли ТипСсылки = Тип("ДокументСсылка.ПередачаТоваров") Тогда
		
		Запрос = Новый Запрос(
		"ВЫБРАТЬ
		|	ТаблицаИдентификаторы.ПубличныйИдентификатор КАК ПубличныйИдентификатор,
		|	ТаблицаИдентификаторы.Идентификатор КАК Идентификатор,
		|	ТаблицаИдентификаторы.Ссылка КАК Ссылка,
		|	Т.ПометкаУдаления КАК ПометкаУдаления,
		|	Т.Проведен КАК Проведен,
		|	Т.Номер КАК Номер,
		|	Т.Дата КАК Дата,
		|	ПРЕДСТАВЛЕНИЕ(Т.ВидОперации) КАК ВидОперации,
		|	Т.СуммаДокумента КАК СуммаДокумента,
		|	ПРЕДСТАВЛЕНИЕ(МАКСИМУМ(Т.Ссылка)) КАК Представление,
		|	""Продажи"" КАК РазделУчета,
		|	Т.Организация КАК Организация,
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(Т.Контрагент) КАК Контрагент_GUID,
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(Т.Склад) КАК Склад_GUID,
		|	Т.Контрагент.ОбособленноеПодразделение КАК Контрагент_ОбособленноеПодразделение,
		|	СУММА(ЕСТЬNULL(ТЧ1.СуммаНДС, 0)) КАК СуммаНДС
		|ИЗ
		|	ТаблицаИдентификаторы КАК ТаблицаИдентификаторы
		|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ПередачаТоваров КАК Т
		|			ЛЕВОЕ СОЕДИНЕНИЕ Документ.ПередачаТоваров.Товары КАК ТЧ1
		|			ПО Т.Ссылка = ТЧ1.Ссылка
		|		ПО (Т.Ссылка = ТаблицаИдентификаторы.Ссылка)
		|
		|СГРУППИРОВАТЬ ПО
		|	ТаблицаИдентификаторы.ПубличныйИдентификатор,
		|	ТаблицаИдентификаторы.Идентификатор,
		|	ТаблицаИдентификаторы.Ссылка,
		|	Т.ПометкаУдаления,
		|	Т.Проведен,
		|	Т.Номер,
		|	Т.Дата,
		|	Т.СуммаДокумента,
		|	Т.Организация,
		|	Т.Контрагент.ОбособленноеПодразделение,
		|	ПРЕДСТАВЛЕНИЕ(Т.ВидОперации),
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(Т.Контрагент),
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(Т.Склад)");
		Запрос.МенеджерВременныхТаблиц = МенеджерВТ;
		
		ИсточникДанных = Запрос.Выполнить();
		ПоляДанныхОбъекта = "Контрагент_GUID,Склад_GUID,Контрагент_ОбособленноеПодразделение,СуммаНДС";
		
	ИначеЕсли ТипСсылки = Тип("ДокументСсылка.ВозвратТоваровПоставщику") Тогда
		
		Запрос = Новый Запрос(
		"ВЫБРАТЬ
		|	ТаблицаИдентификаторы.ПубличныйИдентификатор КАК ПубличныйИдентификатор,
		|	ТаблицаИдентификаторы.Идентификатор КАК Идентификатор,
		|	ТаблицаИдентификаторы.Ссылка КАК Ссылка,
		|	Т.ПометкаУдаления КАК ПометкаУдаления,
		|	Т.Проведен КАК Проведен,
		|	Т.Номер КАК Номер,
		|	Т.Дата КАК Дата,
		|	ПРЕДСТАВЛЕНИЕ(Т.ВидОперации) КАК ВидОперации,
		|	Т.СуммаДокумента КАК СуммаДокумента,
		|	ПРЕДСТАВЛЕНИЕ(МАКСИМУМ(Т.Ссылка)) КАК Представление,
		|	""Продажи"" КАК РазделУчета,
		|	Т.Организация КАК Организация,
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(Т.Контрагент) КАК Контрагент_GUID,
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(Т.Склад) КАК Склад_GUID,
		|	Т.Контрагент.ОбособленноеПодразделение КАК Контрагент_ОбособленноеПодразделение,
		|	СУММА(ЕСТЬNULL(ТЧ1.СуммаНДС, 0)) КАК СуммаНДС
		|ИЗ
		|	ТаблицаИдентификаторы КАК ТаблицаИдентификаторы
		|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ВозвратТоваровПоставщику КАК Т
		|			ЛЕВОЕ СОЕДИНЕНИЕ Документ.ВозвратТоваровПоставщику.Товары КАК ТЧ1
		|			ПО Т.Ссылка = ТЧ1.Ссылка
		|		ПО (Т.Ссылка = ТаблицаИдентификаторы.Ссылка)
		|
		|СГРУППИРОВАТЬ ПО
		|	ТаблицаИдентификаторы.ПубличныйИдентификатор,
		|	ТаблицаИдентификаторы.Идентификатор,
		|	ТаблицаИдентификаторы.Ссылка,
		|	Т.ПометкаУдаления,
		|	Т.Проведен,
		|	Т.Номер,
		|	Т.Дата,
		|	Т.СуммаДокумента,
		|	Т.Организация,
		|	Т.Контрагент.ОбособленноеПодразделение,
		|	ПРЕДСТАВЛЕНИЕ(Т.ВидОперации),
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(Т.Контрагент),
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(Т.Склад)");
		Запрос.МенеджерВременныхТаблиц = МенеджерВТ;
		
		ИсточникДанных = Запрос.Выполнить();
		ПоляДанныхОбъекта = "Контрагент_GUID,Склад_GUID,Контрагент_ОбособленноеПодразделение,СуммаНДС";
		
	ИначеЕсли ТипСсылки = Тип("ДокументСсылка.СчетФактураВыданный") Тогда
		
		Запрос = Новый Запрос(
		"ВЫБРАТЬ
		// Обязательные поля запроса.
		|	ТаблицаИдентификаторы.ПубличныйИдентификатор КАК ПубличныйИдентификатор,
		|	ТаблицаИдентификаторы.Идентификатор КАК Идентификатор,
		|	ТаблицаИдентификаторы.Ссылка КАК Ссылка,
		|	Т.ПометкаУдаления КАК ПометкаУдаления,
		|	Т.Проведен КАК Проведен,
		|	Т.Номер КАК Номер,
		|	Т.Дата КАК Дата,
		|	""Без операции"" КАК ВидОперации,
		|	Т.СуммаДокумента КАК СуммаДокумента,
		|	ПРЕДСТАВЛЕНИЕ(Т.Ссылка) КАК Представление,
		|	""Продажи"" КАК РазделУчета,
		|	Т.Организация КАК Организация,
		// Дополнительные поля данных объекта.
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(Т.Контрагент) КАК Контрагент_GUID,
		|	Т.НомерВходящегоДокумента КАК НомерВходящегоДокумента,
		|	Т.СуммаНДС КАК СуммаНДС,
		|	Т.СуммаНДСДокумента КАК СуммаНДСДокумента,
		|	Т.Контрагент.ОбособленноеПодразделение КАК Контрагент_ОбособленноеПодразделение
		|ИЗ
		|	ТаблицаИдентификаторы КАК ТаблицаИдентификаторы
		|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.СчетФактураВыданный КАК Т
		|		ПО (Т.Ссылка = ТаблицаИдентификаторы.Ссылка)");
		Запрос.МенеджерВременныхТаблиц = МенеджерВТ;
		
		ИсточникДанных = Запрос.Выполнить();
		ПоляДанныхОбъекта = "Контрагент_GUID,Контрагент_ОбособленноеПодразделение,НомерВходящегоДокумента,СуммаНДС,СуммаНДСДокумента";
		
	ИначеЕсли ТипСсылки = Тип("ДокументСсылка.КорректировкаРеализации") Тогда
		
		Запрос = Новый Запрос(
		"ВЫБРАТЬ
		|	ТаблицаИдентификаторы.Ссылка КАК Ссылка,
		|	КорректировкаРеализацииТовары.СуммаНДС КАК СуммаНДС
		|ПОМЕСТИТЬ СуммыДокументов
		|ИЗ
		|	ТаблицаИдентификаторы КАК ТаблицаИдентификаторы
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.КорректировкаРеализации.Товары КАК КорректировкаРеализацииТовары
		|		ПО ТаблицаИдентификаторы.Ссылка = КорректировкаРеализацииТовары.Ссылка
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ТаблицаИдентификаторы.Ссылка,
		|	КорректировкаРеализацииУслуги.СуммаНДС
		|ИЗ
		|	ТаблицаИдентификаторы КАК ТаблицаИдентификаторы
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.КорректировкаРеализации.Услуги КАК КорректировкаРеализацииУслуги
		|		ПО ТаблицаИдентификаторы.Ссылка = КорректировкаРеализацииУслуги.Ссылка
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ТаблицаИдентификаторы.Ссылка,
		|	КорректировкаРеализацииАгентскиеУслуги.СуммаНДС
		|ИЗ
		|	ТаблицаИдентификаторы КАК ТаблицаИдентификаторы
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.КорректировкаРеализации.АгентскиеУслуги КАК КорректировкаРеализацииАгентскиеУслуги
		|		ПО ТаблицаИдентификаторы.Ссылка = КорректировкаРеализацииАгентскиеУслуги.Ссылка
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ТаблицаИдентификаторы.ПубличныйИдентификатор КАК ПубличныйИдентификатор,
		|	ТаблицаИдентификаторы.Идентификатор КАК Идентификатор,
		|	ТаблицаИдентификаторы.Ссылка КАК Ссылка,
		|	КорректировкаРеализации.ПометкаУдаления КАК ПометкаУдаления,
		|	КорректировкаРеализации.Проведен КАК Проведен,
		|	КорректировкаРеализации.Номер КАК Номер,
		|	КорректировкаРеализации.Дата КАК Дата,
		|	ПРЕДСТАВЛЕНИЕ(КорректировкаРеализации.ВидОперации) КАК ВидОперации,
		|	КорректировкаРеализации.СуммаДокумента КАК СуммаДокумента,
		|	ПРЕДСТАВЛЕНИЕ(КорректировкаРеализации.Ссылка) КАК Представление,
		|	""Продажи"" КАК РазделУчета,
		|	КорректировкаРеализации.Организация КАК Организация,
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(КорректировкаРеализации.Контрагент) КАК Контрагент_GUID,
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(КорректировкаРеализации.Склад) КАК Склад_GUID,
		|	КорректировкаРеализации.Контрагент.ОбособленноеПодразделение КАК Контрагент_ОбособленноеПодразделение,
		|	СУММА(ЕСТЬNULL(СуммыДокументов.СуммаНДС, 0)) КАК СуммаНДС
		|ИЗ
		|	ТаблицаИдентификаторы КАК ТаблицаИдентификаторы
		|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.КорректировкаРеализации КАК КорректировкаРеализации
		|		ПО (КорректировкаРеализации.Ссылка = ТаблицаИдентификаторы.Ссылка)
		|		ЛЕВОЕ СОЕДИНЕНИЕ СуммыДокументов КАК СуммыДокументов
		|		ПО (СуммыДокументов.Ссылка = ТаблицаИдентификаторы.Ссылка)
		|
		|СГРУППИРОВАТЬ ПО
		|	ТаблицаИдентификаторы.ПубличныйИдентификатор,
		|	ТаблицаИдентификаторы.Идентификатор,
		|	ТаблицаИдентификаторы.Ссылка,
		|	КорректировкаРеализации.ПометкаУдаления,
		|	КорректировкаРеализации.Проведен,
		|	КорректировкаРеализации.Номер,
		|	КорректировкаРеализации.Дата,
		|	КорректировкаРеализации.СуммаДокумента,
		|	КорректировкаРеализации.Организация,
		|	КорректировкаРеализации.Контрагент.ОбособленноеПодразделение,
		|	ПРЕДСТАВЛЕНИЕ(КорректировкаРеализации.ВидОперации),
		|	ПРЕДСТАВЛЕНИЕ(КорректировкаРеализации.Ссылка),
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(КорректировкаРеализации.Контрагент),
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(КорректировкаРеализации.Склад)");
		Запрос.МенеджерВременныхТаблиц = МенеджерВТ;
		
		ИсточникДанных = Запрос.Выполнить();
		ПоляДанныхОбъекта = "Контрагент_GUID,Склад_GUID,Контрагент_ОбособленноеПодразделение,СуммаНДС";
		
	ИначеЕсли ТипСсылки = Тип("ДокументСсылка.ОтчетОРозничныхПродажах") Тогда
		
		Запрос = Новый Запрос(
		"ВЫБРАТЬ
		|	ТаблицаИдентификаторы.Ссылка КАК Ссылка,
		|	ОтчетОРозничныхПродажахТовары.СуммаНДС КАК СуммаНДС
		|ПОМЕСТИТЬ СуммыДокументов
		|ИЗ
		|	ТаблицаИдентификаторы КАК ТаблицаИдентификаторы
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.ОтчетОРозничныхПродажах.Товары КАК ОтчетОРозничныхПродажахТовары
		|		ПО ТаблицаИдентификаторы.Ссылка = ОтчетОРозничныхПродажахТовары.Ссылка
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ТаблицаИдентификаторы.Ссылка,
		|	ОтчетОРозничныхПродажахАгентскиеУслуги.СуммаНДС
		|ИЗ
		|	ТаблицаИдентификаторы КАК ТаблицаИдентификаторы
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.ОтчетОРозничныхПродажах.АгентскиеУслуги КАК ОтчетОРозничныхПродажахАгентскиеУслуги
		|		ПО ТаблицаИдентификаторы.Ссылка = ОтчетОРозничныхПродажахАгентскиеУслуги.Ссылка
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ТаблицаИдентификаторы.Ссылка,
		|	ОтчетОРозничныхПродажахОплатаСчетов.СуммаНДС
		|ИЗ
		|	ТаблицаИдентификаторы КАК ТаблицаИдентификаторы
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.ОтчетОРозничныхПродажах.ОплатаСчетов КАК ОтчетОРозничныхПродажахОплатаСчетов
		|		ПО ТаблицаИдентификаторы.Ссылка = ОтчетОРозничныхПродажахОплатаСчетов.Ссылка
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ТаблицаИдентификаторы.ПубличныйИдентификатор КАК ПубличныйИдентификатор,
		|	ТаблицаИдентификаторы.Идентификатор КАК Идентификатор,
		|	ТаблицаИдентификаторы.Ссылка КАК Ссылка,
		|	ОтчетОРозничныхПродажах.ПометкаУдаления КАК ПометкаУдаления,
		|	ОтчетОРозничныхПродажах.Проведен КАК Проведен,
		|	ОтчетОРозничныхПродажах.Номер КАК Номер,
		|	ОтчетОРозничныхПродажах.Дата КАК Дата,
		|	ПРЕДСТАВЛЕНИЕ(ОтчетОРозничныхПродажах.ВидОперации) КАК ВидОперации,
		|	ОтчетОРозничныхПродажах.СуммаДокумента КАК СуммаДокумента,
		|	ПРЕДСТАВЛЕНИЕ(ОтчетОРозничныхПродажах.Ссылка) КАК Представление,
		|	""Продажи"" КАК РазделУчета,
		|	ОтчетОРозничныхПродажах.Организация КАК Организация,
		|	ОтчетОРозничныхПродажах.ДеятельностьНаПатенте КАК ДеятельностьНаПатенте,
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(ОтчетОРозничныхПродажах.Склад) КАК Склад_GUID,
		|	СУММА(ЕСТЬNULL(СуммыДокументов.СуммаНДС, 0)) КАК СуммаНДС
		|ИЗ
		|	ТаблицаИдентификаторы КАК ТаблицаИдентификаторы
		|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ОтчетОРозничныхПродажах КАК ОтчетОРозничныхПродажах
		|		ПО (ОтчетОРозничныхПродажах.Ссылка = ТаблицаИдентификаторы.Ссылка)
		|		ЛЕВОЕ СОЕДИНЕНИЕ СуммыДокументов КАК СуммыДокументов
		|		ПО (СуммыДокументов.Ссылка = ТаблицаИдентификаторы.Ссылка)
		|
		|СГРУППИРОВАТЬ ПО
		|	ТаблицаИдентификаторы.ПубличныйИдентификатор,
		|	ТаблицаИдентификаторы.Идентификатор,
		|	ТаблицаИдентификаторы.Ссылка,
		|	ОтчетОРозничныхПродажах.ПометкаУдаления,
		|	ОтчетОРозничныхПродажах.Проведен,
		|	ОтчетОРозничныхПродажах.Номер,
		|	ОтчетОРозничныхПродажах.Дата,
		|	ОтчетОРозничныхПродажах.СуммаДокумента,
		|	ОтчетОРозничныхПродажах.Организация,
		|	ОтчетОРозничныхПродажах.ДеятельностьНаПатенте,
		|	ПРЕДСТАВЛЕНИЕ(ОтчетОРозничныхПродажах.ВидОперации),
		|	ПРЕДСТАВЛЕНИЕ(ОтчетОРозничныхПродажах.Ссылка),
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(ОтчетОРозничныхПродажах.Склад)");
		Запрос.МенеджерВременныхТаблиц = МенеджерВТ;
		
		ИсточникДанных = Запрос.Выполнить();
		ПоляДанныхОбъекта = "ДеятельностьНаПатенте,Склад_GUID,СуммаНДС";
		
	ИначеЕсли ТипСсылки = Тип("ДокументСсылка.ПереоценкаТоваровВРознице") Тогда
		
		Запрос = Новый Запрос(
		"ВЫБРАТЬ
		// Обязательные поля запроса.
		|	ТаблицаИдентификаторы.ПубличныйИдентификатор КАК ПубличныйИдентификатор,
		|	ТаблицаИдентификаторы.Идентификатор КАК Идентификатор,
		|	ТаблицаИдентификаторы.Ссылка КАК Ссылка,
		|	Т.ПометкаУдаления КАК ПометкаУдаления,
		|	Т.Проведен КАК Проведен,
		|	Т.Номер КАК Номер,
		|	Т.Дата КАК Дата,
		|	""Без операции"" КАК ВидОперации,
		|	0 КАК СуммаДокумента,
		|	ПРЕДСТАВЛЕНИЕ(Т.Ссылка) КАК Представление,
		|	""Продажи"" КАК РазделУчета,
		|	Т.Организация КАК Организация,
		// Дополнительные поля данных объекта.
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(Т.Склад) КАК Склад_GUID
		|ИЗ
		|	ТаблицаИдентификаторы КАК ТаблицаИдентификаторы
		|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ПереоценкаТоваровВРознице КАК Т
		|		ПО (Т.Ссылка = ТаблицаИдентификаторы.Ссылка)");
		Запрос.МенеджерВременныхТаблиц = МенеджерВТ;
		
		ИсточникДанных = Запрос.Выполнить();
		ПоляДанныхОбъекта = "Склад_GUID";
		
	ИначеЕсли ТипСсылки = Тип("ДокументСсылка.КорректировкаДолга") Тогда
		
		Запрос = Новый Запрос(
		"ВЫБРАТЬ
		// Обязательные поля запроса.
		|	ТаблицаИдентификаторы.ПубличныйИдентификатор КАК ПубличныйИдентификатор,
		|	ТаблицаИдентификаторы.Идентификатор КАК Идентификатор,
		|	ТаблицаИдентификаторы.Ссылка КАК Ссылка,
		|	Т.ПометкаУдаления КАК ПометкаУдаления,
		|	Т.Проведен КАК Проведен,
		|	Т.Номер КАК Номер,
		|	Т.Дата КАК Дата,
		|	ПРЕДСТАВЛЕНИЕ(Т.ВидОперации) КАК ВидОперации,
		|	0 КАК СуммаДокумента,
		|	ПРЕДСТАВЛЕНИЕ(Т.Ссылка) КАК Представление,
		|	""Прочее"" КАК РазделУчета,
		|	Т.Организация КАК Организация,	
		// Дополнительные поля данных объекта.
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(Т.КонтрагентДебитор) КАК КонтрагентДебитор_GUID,
		|	Т.КонтрагентДебитор.ОбособленноеПодразделение КАК КонтрагентДебитор_ОбособленноеПодразделение,
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(Т.КонтрагентКредитор) КАК КонтрагентКредитор_GUID,
		|	Т.КонтрагентКредитор.ОбособленноеПодразделение КАК КонтрагентКредитор_ОбособленноеПодразделение
		|ИЗ
		|	ТаблицаИдентификаторы КАК ТаблицаИдентификаторы
		|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.КорректировкаДолга КАК Т
		|		ПО (Т.Ссылка = ТаблицаИдентификаторы.Ссылка)");
		Запрос.МенеджерВременныхТаблиц = МенеджерВТ;
		
		ИсточникДанных = Запрос.Выполнить();
		ПоляДанныхОбъекта = "КонтрагентДебитор_GUID,КонтрагентДебитор_ОбособленноеПодразделение,КонтрагентКредитор_GUID,КонтрагентКредитор_ОбособленноеПодразделение";
		
	ИначеЕсли ТипСсылки = Тип("ДокументСсылка.УстановкаЦенНоменклатуры") Тогда
		
		Запрос = Новый Запрос(
		"ВЫБРАТЬ
		// Обязательные поля запроса.
		|	ТаблицаИдентификаторы.ПубличныйИдентификатор КАК ПубличныйИдентификатор,
		|	ТаблицаИдентификаторы.Идентификатор КАК Идентификатор,
		|	ТаблицаИдентификаторы.Ссылка КАК Ссылка,
		|	Т.ПометкаУдаления КАК ПометкаУдаления,
		|	Т.Проведен КАК Проведен,
		|	Т.Номер КАК Номер,
		|	Т.Дата КАК Дата,
		|	""Без операции"" КАК ВидОперации,
		|	0 КАК СуммаДокумента,
		|	ПРЕДСТАВЛЕНИЕ(Т.Ссылка) КАК Представление,
		|	""Продажи"" КАК РазделУчета,
		|	""Все организации"" КАК Организация	
		// Дополнительные поля данных объекта.
		|ИЗ
		|	ТаблицаИдентификаторы КАК ТаблицаИдентификаторы
		|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.УстановкаЦенНоменклатуры КАК Т
		|		ПО (Т.Ссылка = ТаблицаИдентификаторы.Ссылка)");
		Запрос.МенеджерВременныхТаблиц = МенеджерВТ;
		
		ИсточникДанных = Запрос.Выполнить();
		ПоляДанныхОбъекта = "";
		
	ИначеЕсли ТипСсылки = Тип("ДокументСсылка.ОтчетКомиссионераОПродажах") Тогда
		
		Запрос = Новый Запрос(
		"ВЫБРАТЬ
		|	ТаблицаИдентификаторы.Ссылка КАК Ссылка,
		|	ОтчетКомиссионераОПродажахТовары.СуммаНДС КАК СуммаНДС
		|ПОМЕСТИТЬ СуммыДокументов
		|ИЗ
		|	ТаблицаИдентификаторы КАК ТаблицаИдентификаторы
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.ОтчетКомиссионераОПродажах.Товары КАК ОтчетКомиссионераОПродажахТовары
		|		ПО ТаблицаИдентификаторы.Ссылка = ОтчетКомиссионераОПродажахТовары.Ссылка
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ТаблицаИдентификаторы.Ссылка,
		|	ОтчетКомиссионераОПродажахУслуги.СуммаНДС
		|ИЗ
		|	ТаблицаИдентификаторы КАК ТаблицаИдентификаторы
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.ОтчетКомиссионераОПродажах.Услуги КАК ОтчетКомиссионераОПродажахУслуги
		|		ПО ТаблицаИдентификаторы.Ссылка = ОтчетКомиссионераОПродажахУслуги.Ссылка
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ТаблицаИдентификаторы.ПубличныйИдентификатор КАК ПубличныйИдентификатор,
		|	ТаблицаИдентификаторы.Идентификатор КАК Идентификатор,
		|	ТаблицаИдентификаторы.Ссылка КАК Ссылка,
		|	ОтчетКомиссионераОПродажах.ПометкаУдаления КАК ПометкаУдаления,
		|	ОтчетКомиссионераОПродажах.Проведен КАК Проведен,
		|	ОтчетКомиссионераОПродажах.Номер КАК Номер,
		|	ОтчетКомиссионераОПродажах.Дата КАК Дата,
		|	ПРЕДСТАВЛЕНИЕ(ОтчетКомиссионераОПродажах.ВидОперации) КАК ВидОперации,
		|	ОтчетКомиссионераОПродажах.СуммаДокумента КАК СуммаДокумента,
		|	ПРЕДСТАВЛЕНИЕ(ОтчетКомиссионераОПродажах.Ссылка) КАК Представление,
		|	""Продажи"" КАК РазделУчета,
		|	ОтчетКомиссионераОПродажах.Организация КАК Организация,
		|	ОтчетКомиссионераОПродажах.ДеятельностьНаПатенте КАК ДеятельностьНаПатенте,
		|	ОтчетКомиссионераОПродажах.НомерВходящегоДокумента КАК НомерВходящегоДокумента,
		|	ОтчетКомиссионераОПродажах.ДатаВходящегоДокумента КАК ДатаВходящегоДокумента,
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(ОтчетКомиссионераОПродажах.Контрагент) КАК Контрагент_GUID,
		|	ОтчетКомиссионераОПродажах.Контрагент.ОбособленноеПодразделение КАК Контрагент_ОбособленноеПодразделение,
		|	СУММА(ЕСТЬNULL(СуммыДокументов.СуммаНДС, 0)) КАК СуммаНДС,
		|	ОтчетКомиссионераОПродажах.СпособРасчетаКомиссионногоВознаграждения КАК СпособРасчетаКомиссионногоВознаграждения,
		|	ОтчетКомиссионераОПродажах.ПроцентКомиссионногоВознаграждения КАК ПроцентКомиссионногоВознаграждения,
		|	ОтчетКомиссионераОПродажах.СуммаВознаграждения КАК СуммаВознаграждения,
		|	ОтчетКомиссионераОПродажах.СтавкаНДСВознаграждения КАК СтавкаНДСВознаграждения
		|ИЗ
		|	ТаблицаИдентификаторы КАК ТаблицаИдентификаторы
		|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ОтчетКомиссионераОПродажах КАК ОтчетКомиссионераОПродажах
		|		ПО (ОтчетКомиссионераОПродажах.Ссылка = ТаблицаИдентификаторы.Ссылка)
		|		ЛЕВОЕ СОЕДИНЕНИЕ СуммыДокументов КАК СуммыДокументов
		|		ПО (СуммыДокументов.Ссылка = ТаблицаИдентификаторы.Ссылка)
		|
		|СГРУППИРОВАТЬ ПО
		|	ТаблицаИдентификаторы.ПубличныйИдентификатор,
		|	ТаблицаИдентификаторы.Идентификатор,
		|	ТаблицаИдентификаторы.Ссылка,
		|	ОтчетКомиссионераОПродажах.ПометкаУдаления,
		|	ОтчетКомиссионераОПродажах.Проведен,
		|	ОтчетКомиссионераОПродажах.Номер,
		|	ОтчетКомиссионераОПродажах.Дата,
		|	ОтчетКомиссионераОПродажах.СуммаДокумента,
		|	ОтчетКомиссионераОПродажах.Организация,
		|	ОтчетКомиссионераОПродажах.ДеятельностьНаПатенте,
		|	ОтчетКомиссионераОПродажах.НомерВходящегоДокумента,
		|	ОтчетКомиссионераОПродажах.ДатаВходящегоДокумента,
		|	ОтчетКомиссионераОПродажах.Контрагент.ОбособленноеПодразделение,
		|	ОтчетКомиссионераОПродажах.СпособРасчетаКомиссионногоВознаграждения,
		|	ОтчетКомиссионераОПродажах.ПроцентКомиссионногоВознаграждения,
		|	ОтчетКомиссионераОПродажах.СуммаВознаграждения,
		|	ОтчетКомиссионераОПродажах.СтавкаНДСВознаграждения,
		|	ПРЕДСТАВЛЕНИЕ(ОтчетКомиссионераОПродажах.ВидОперации),
		|	ПРЕДСТАВЛЕНИЕ(ОтчетКомиссионераОПродажах.Ссылка),
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(ОтчетКомиссионераОПродажах.Контрагент)");
		Запрос.МенеджерВременныхТаблиц = МенеджерВТ;
		
		ИсточникДанных = Запрос.Выполнить();
		ПоляДанныхОбъекта = "ДеятельностьНаПатенте,Контрагент_GUID,Контрагент_ОбособленноеПодразделение,НомерВходящегоДокумента,ДатаВходящегоДокумента,СуммаНДС,СпособРасчетаКомиссионногоВознаграждения,ПроцентКомиссионногоВознаграждения,СуммаВознаграждения,СтавкаНДСВознаграждения";
		
	ИначеЕсли ТипСсылки = Тип("ДокументСсылка.ВозвратТоваровОтПокупателя") Тогда
		
		Запрос = Новый Запрос(
		"ВЫБРАТЬ
		|	ТаблицаИдентификаторы.ПубличныйИдентификатор КАК ПубличныйИдентификатор,
		|	ТаблицаИдентификаторы.Идентификатор КАК Идентификатор,
		|	ТаблицаИдентификаторы.Ссылка КАК Ссылка,
		|	Т.ПометкаУдаления КАК ПометкаУдаления,
		|	Т.Проведен КАК Проведен,
		|	Т.Номер КАК Номер,
		|	Т.Дата КАК Дата,
		|	ПРЕДСТАВЛЕНИЕ(Т.ВидОперации) КАК ВидОперации,
		|	Т.СуммаДокумента КАК СуммаДокумента,
		|	ПРЕДСТАВЛЕНИЕ(МАКСИМУМ(Т.Ссылка)) КАК Представление,
		|	""Продажи"" КАК РазделУчета,
		|	Т.Организация КАК Организация,
		|	Т.ДеятельностьНаПатенте КАК ДеятельностьНаПатенте,
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(Т.Контрагент) КАК Контрагент_GUID,
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(Т.Склад) КАК Склад_GUID,
		|	Т.Контрагент.ОбособленноеПодразделение КАК Контрагент_ОбособленноеПодразделение,
		|	СУММА(ЕСТЬNULL(ТЧ1.СуммаНДС, 0)) КАК СуммаНДС
		|ИЗ
		|	ТаблицаИдентификаторы КАК ТаблицаИдентификаторы
		|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ВозвратТоваровОтПокупателя КАК Т
		|			ЛЕВОЕ СОЕДИНЕНИЕ Документ.ВозвратТоваровОтПокупателя.Товары КАК ТЧ1
		|			ПО Т.Ссылка = ТЧ1.Ссылка
		|		ПО (Т.Ссылка = ТаблицаИдентификаторы.Ссылка)
		|
		|СГРУППИРОВАТЬ ПО
		|	ТаблицаИдентификаторы.ПубличныйИдентификатор,
		|	ТаблицаИдентификаторы.Идентификатор,
		|	ТаблицаИдентификаторы.Ссылка,
		|	Т.ПометкаУдаления,
		|	Т.Проведен,
		|	Т.Номер,
		|	Т.Дата,
		|	Т.СуммаДокумента,
		|	Т.Организация,
		|	Т.ДеятельностьНаПатенте,
		|	Т.Контрагент.ОбособленноеПодразделение,
		|	ПРЕДСТАВЛЕНИЕ(Т.ВидОперации),
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(Т.Контрагент),
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(Т.Склад)");
		Запрос.МенеджерВременныхТаблиц = МенеджерВТ;
		
		ИсточникДанных = Запрос.Выполнить();
		ПоляДанныхОбъекта = "ДеятельностьНаПатенте,Контрагент_GUID,Склад_GUID,Контрагент_ОбособленноеПодразделение,СуммаНДС";
		
	ИначеЕсли ТипСсылки = Тип("ДокументСсылка.СписаниеТоваров") Тогда
		
		Запрос = Новый Запрос(
		"ВЫБРАТЬ
		// Обязательные поля запроса.
		|	ТаблицаИдентификаторы.ПубличныйИдентификатор КАК ПубличныйИдентификатор,
		|	ТаблицаИдентификаторы.Идентификатор КАК Идентификатор,
		|	ТаблицаИдентификаторы.Ссылка КАК Ссылка,
		|	Т.ПометкаУдаления КАК ПометкаУдаления,
		|	Т.Проведен КАК Проведен,
		|	Т.Номер КАК Номер,
		|	Т.Дата КАК Дата,
		|	ПРЕДСТАВЛЕНИЕ(Т.ВидОперации) КАК ВидОперации,
		|	Т.СуммаДокумента КАК СуммаДокумента,
		|	ПРЕДСТАВЛЕНИЕ(Т.Ссылка) КАК Представление,
		|	""Продажи"" КАК РазделУчета,
		|	Т.Организация КАК Организация,	
		// Дополнительные поля данных объекта.
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(Т.Склад) КАК Склад_GUID
		|ИЗ
		|	ТаблицаИдентификаторы КАК ТаблицаИдентификаторы
		|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.СписаниеТоваров КАК Т
		|		ПО (Т.Ссылка = ТаблицаИдентификаторы.Ссылка)");
		Запрос.МенеджерВременныхТаблиц = МенеджерВТ;
		
		ИсточникДанных = Запрос.Выполнить();
		ПоляДанныхОбъекта = "Склад_GUID";
		
	ИначеЕсли ТипСсылки = Тип("ДокументСсылка.ТребованиеНакладная") Тогда
		
		Запрос = Новый Запрос(
		"ВЫБРАТЬ
		// Обязательные поля запроса.
		|	ТаблицаИдентификаторы.ПубличныйИдентификатор КАК ПубличныйИдентификатор,
		|	ТаблицаИдентификаторы.Идентификатор КАК Идентификатор,
		|	ТаблицаИдентификаторы.Ссылка КАК Ссылка,
		|	Т.ПометкаУдаления КАК ПометкаУдаления,
		|	Т.Проведен КАК Проведен,
		|	Т.Номер КАК Номер,
		|	Т.Дата КАК Дата,
		|	ПРЕДСТАВЛЕНИЕ(Т.ВидОперации) КАК ВидОперации,
		|	0 КАК СуммаДокумента,
		|	ПРЕДСТАВЛЕНИЕ(Т.Ссылка) КАК Представление,
		|	""Прочее"" КАК РазделУчета,
		|	Т.Организация КАК Организация,	
		// Дополнительные поля данных объекта.
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(Т.Склад) КАК Склад_GUID
		|ИЗ
		|	ТаблицаИдентификаторы КАК ТаблицаИдентификаторы
		|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ТребованиеНакладная КАК Т
		|		ПО (Т.Ссылка = ТаблицаИдентификаторы.Ссылка)");
		Запрос.МенеджерВременныхТаблиц = МенеджерВТ;
		
		ИсточникДанных = Запрос.Выполнить();
		ПоляДанныхОбъекта = "Склад_GUID";
		
	// Закупки
	ИначеЕсли ТипСсылки = Тип("ДокументСсылка.СчетНаОплатуПоставщика") Тогда
		
		Запрос = Новый Запрос(
		"ВЫБРАТЬ
		|	ТаблицаИдентификаторы.ПубличныйИдентификатор КАК ПубличныйИдентификатор,
		|	ТаблицаИдентификаторы.Идентификатор КАК Идентификатор,
		|	ТаблицаИдентификаторы.Ссылка КАК Ссылка,
		|	Т.ПометкаУдаления КАК ПометкаУдаления,
		|	Т.Проведен КАК Проведен,
		|	Т.Номер КАК Номер,
		|	Т.Дата КАК Дата,
		|	""Без операции"" КАК ВидОперации,
		|	Т.СуммаДокумента КАК СуммаДокумента,
		|	ПРЕДСТАВЛЕНИЕ(МАКСИМУМ(Т.Ссылка)) КАК Представление,
		|	""Закупки"" КАК РазделУчета,
		|	Т.Организация КАК Организация,
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(Т.Контрагент) КАК Контрагент_GUID,
		|	Т.НомерВходящегоДокумента КАК НомерВходящегоДокумента,
		|	Т.ДатаВходящегоДокумента КАК ДатаВходящегоДокумента,
		|	Т.Контрагент.ОбособленноеПодразделение КАК Контрагент_ОбособленноеПодразделение,
		|	СУММА(ЕСТЬNULL(ТЧ1.СуммаНДС, 0)) КАК СуммаНДС
		|ИЗ
		|	ТаблицаИдентификаторы КАК ТаблицаИдентификаторы
		|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.СчетНаОплатуПоставщика КАК Т
		|			ЛЕВОЕ СОЕДИНЕНИЕ Документ.СчетНаОплатуПоставщика.Товары КАК ТЧ1
		|			ПО Т.Ссылка = ТЧ1.Ссылка
		|		ПО (Т.Ссылка = ТаблицаИдентификаторы.Ссылка)
		|
		|СГРУППИРОВАТЬ ПО
		|	ТаблицаИдентификаторы.ПубличныйИдентификатор,
		|	ТаблицаИдентификаторы.Идентификатор,
		|	ТаблицаИдентификаторы.Ссылка,
		|	Т.ПометкаУдаления,
		|	Т.Проведен,
		|	Т.Номер,
		|	Т.Дата,
		|	Т.СуммаДокумента,
		|	Т.Организация,
		|	Т.НомерВходящегоДокумента,
		|	Т.ДатаВходящегоДокумента,
		|	Т.Контрагент.ОбособленноеПодразделение,
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(Т.Контрагент)");
		Запрос.МенеджерВременныхТаблиц = МенеджерВТ;
		
		ИсточникДанных = Запрос.Выполнить();
		ПоляДанныхОбъекта = "Контрагент_GUID,Контрагент_ОбособленноеПодразделение,НомерВходящегоДокумента,ДатаВходящегоДокумента,СуммаНДС";
		
	ИначеЕсли ТипСсылки = Тип("ДокументСсылка.ПоступлениеТоваровУслуг") Тогда
		
		Запрос = Новый Запрос(
		"ВЫБРАТЬ
		|	ТаблицаИдентификаторы.Ссылка КАК Ссылка,
		|	ПоступлениеТоваровУслугТовары.СуммаНДС КАК СуммаНДС
		|ПОМЕСТИТЬ СуммыДокументов
		|ИЗ
		|	ТаблицаИдентификаторы КАК ТаблицаИдентификаторы
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.ПоступлениеТоваровУслуг.Товары КАК ПоступлениеТоваровУслугТовары
		|		ПО ТаблицаИдентификаторы.Ссылка = ПоступлениеТоваровУслугТовары.Ссылка
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ТаблицаИдентификаторы.Ссылка,
		|	ПоступлениеТоваровУслугОборудование.СуммаНДС
		|ИЗ
		|	ТаблицаИдентификаторы КАК ТаблицаИдентификаторы
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.ПоступлениеТоваровУслуг.Оборудование КАК ПоступлениеТоваровУслугОборудование
		|		ПО ТаблицаИдентификаторы.Ссылка = ПоступлениеТоваровУслугОборудование.Ссылка
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ТаблицаИдентификаторы.Ссылка,
		|	ПоступлениеТоваровУслугОбъектыСтроительства.СуммаНДС
		|ИЗ
		|	ТаблицаИдентификаторы КАК ТаблицаИдентификаторы
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.ПоступлениеТоваровУслуг.ОбъектыСтроительства КАК ПоступлениеТоваровУслугОбъектыСтроительства
		|		ПО ТаблицаИдентификаторы.Ссылка = ПоступлениеТоваровУслугОбъектыСтроительства.Ссылка
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ТаблицаИдентификаторы.Ссылка,
		|	ПоступлениеТоваровУслугУслуги.СуммаНДС
		|ИЗ
		|	ТаблицаИдентификаторы КАК ТаблицаИдентификаторы
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.ПоступлениеТоваровУслуг.Услуги КАК ПоступлениеТоваровУслугУслуги
		|		ПО ТаблицаИдентификаторы.Ссылка = ПоступлениеТоваровУслугУслуги.Ссылка
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ТаблицаИдентификаторы.Ссылка,
		|	ПоступлениеТоваровУслугАгентскиеУслуги.СуммаНДС
		|ИЗ
		|	ТаблицаИдентификаторы КАК ТаблицаИдентификаторы
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.ПоступлениеТоваровУслуг.АгентскиеУслуги КАК ПоступлениеТоваровУслугАгентскиеУслуги
		|		ПО ТаблицаИдентификаторы.Ссылка = ПоступлениеТоваровУслугАгентскиеУслуги.Ссылка
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ТаблицаИдентификаторы.ПубличныйИдентификатор КАК ПубличныйИдентификатор,
		|	ТаблицаИдентификаторы.Идентификатор КАК Идентификатор,
		|	ТаблицаИдентификаторы.Ссылка КАК Ссылка,
		|	ПоступлениеТоваровУслуг.ПометкаУдаления КАК ПометкаУдаления,
		|	ПоступлениеТоваровУслуг.Проведен КАК Проведен,
		|	ПоступлениеТоваровУслуг.Номер КАК Номер,
		|	ПоступлениеТоваровУслуг.Дата КАК Дата,
		|	ПРЕДСТАВЛЕНИЕ(ПоступлениеТоваровУслуг.ВидОперации) КАК ВидОперации,
		|	ПоступлениеТоваровУслуг.СуммаДокумента КАК СуммаДокумента,
		|	ПРЕДСТАВЛЕНИЕ(ПоступлениеТоваровУслуг.Ссылка) КАК Представление,
		|	""Закупки"" КАК РазделУчета,
		|	ПоступлениеТоваровУслуг.Организация КАК Организация,
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(ПоступлениеТоваровУслуг.Контрагент) КАК Контрагент_GUID,
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(ПоступлениеТоваровУслуг.Склад) КАК Склад_GUID,
		|	ПоступлениеТоваровУслуг.НомерВходящегоДокумента КАК НомерВходящегоДокумента,
		|	ПоступлениеТоваровУслуг.ДатаВходящегоДокумента КАК ДатаВходящегоДокумента,
		|	СУММА(ЕСТЬNULL(СуммыДокументов.СуммаНДС, 0)) КАК СуммаНДС,
		|	ПоступлениеТоваровУслуг.Контрагент.ОбособленноеПодразделение КАК Контрагент_ОбособленноеПодразделение
		|ИЗ
		|	ТаблицаИдентификаторы КАК ТаблицаИдентификаторы
		|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ПоступлениеТоваровУслуг КАК ПоступлениеТоваровУслуг
		|		ПО (ПоступлениеТоваровУслуг.Ссылка = ТаблицаИдентификаторы.Ссылка)
		|		ЛЕВОЕ СОЕДИНЕНИЕ СуммыДокументов КАК СуммыДокументов
		|		ПО (СуммыДокументов.Ссылка = ТаблицаИдентификаторы.Ссылка)
		|
		|СГРУППИРОВАТЬ ПО
		|	ТаблицаИдентификаторы.ПубличныйИдентификатор,
		|	ТаблицаИдентификаторы.Идентификатор,
		|	ТаблицаИдентификаторы.Ссылка,
		|	ПоступлениеТоваровУслуг.ПометкаУдаления,
		|	ПоступлениеТоваровУслуг.Проведен,
		|	ПоступлениеТоваровУслуг.Номер,
		|	ПоступлениеТоваровУслуг.Дата,
		|	ПоступлениеТоваровУслуг.СуммаДокумента,
		|	ПоступлениеТоваровУслуг.Организация,
		|	ПоступлениеТоваровУслуг.НомерВходящегоДокумента,
		|	ПоступлениеТоваровУслуг.ДатаВходящегоДокумента,
		|	ПоступлениеТоваровУслуг.Контрагент.ОбособленноеПодразделение,
		|	ПРЕДСТАВЛЕНИЕ(ПоступлениеТоваровУслуг.ВидОперации),
		|	ПРЕДСТАВЛЕНИЕ(ПоступлениеТоваровУслуг.Ссылка),
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(ПоступлениеТоваровУслуг.Контрагент),
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(ПоступлениеТоваровУслуг.Склад)");
		Запрос.МенеджерВременныхТаблиц = МенеджерВТ;
		ИсточникДанных = Запрос.Выполнить();
		ПоляДанныхОбъекта = "Контрагент_GUID,Склад_GUID,Контрагент_ОбособленноеПодразделение,НомерВходящегоДокумента,ДатаВходящегоДокумента,СуммаНДС";
		
	ИначеЕсли ТипСсылки = Тип("ДокументСсылка.ПоступлениеИзПереработки") Тогда
		
		Запрос = Новый Запрос(
		"ВЫБРАТЬ
		|	ТаблицаИдентификаторы.ПубличныйИдентификатор КАК ПубличныйИдентификатор,
		|	ТаблицаИдентификаторы.Идентификатор КАК Идентификатор,
		|	ТаблицаИдентификаторы.Ссылка КАК Ссылка,
		|	Т.ПометкаУдаления КАК ПометкаУдаления,
		|	Т.Проведен КАК Проведен,
		|	Т.Номер КАК Номер,
		|	Т.Дата КАК Дата,
		|	""Без операции"" КАК ВидОперации,
		|	Т.СуммаДокумента КАК СуммаДокумента,
		|	ПРЕДСТАВЛЕНИЕ(МАКСИМУМ(Т.Ссылка)) КАК Представление,
		|	""Закупки"" КАК РазделУчета,
		|	Т.Организация КАК Организация,
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(Т.Контрагент) КАК Контрагент_GUID,
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(Т.Склад) КАК Склад_GUID,
		|	Т.Контрагент.ОбособленноеПодразделение КАК Контрагент_ОбособленноеПодразделение,
		|	СУММА(ЕСТЬNULL(ТЧ1.СуммаНДС, 0)) КАК СуммаНДС
		|ИЗ
		|	ТаблицаИдентификаторы КАК ТаблицаИдентификаторы
		|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ПоступлениеИзПереработки КАК Т
		|			ЛЕВОЕ СОЕДИНЕНИЕ Документ.ПоступлениеИзПереработки.Услуги КАК ТЧ1
		|			ПО Т.Ссылка = ТЧ1.Ссылка
		|		ПО (Т.Ссылка = ТаблицаИдентификаторы.Ссылка)
		|
		|СГРУППИРОВАТЬ ПО
		|	ТаблицаИдентификаторы.ПубличныйИдентификатор,
		|	ТаблицаИдентификаторы.Идентификатор,
		|	ТаблицаИдентификаторы.Ссылка,
		|	Т.ПометкаУдаления,
		|	Т.Проведен,
		|	Т.Номер,
		|	Т.Дата,
		|	Т.СуммаДокумента,
		|	Т.Организация,
		|	Т.Контрагент.ОбособленноеПодразделение,
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(Т.Контрагент),
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(Т.Склад)");
		Запрос.МенеджерВременныхТаблиц = МенеджерВТ;
		
		ИсточникДанных = Запрос.Выполнить();
		ПоляДанныхОбъекта = "Контрагент_GUID,Склад_GUID,Контрагент_ОбособленноеПодразделение,СуммаНДС";
		
	ИначеЕсли ТипСсылки = Тип("ДокументСсылка.СчетФактураПолученный") Тогда
		
		Запрос = Новый Запрос(
		"ВЫБРАТЬ
		// Обязательные поля запроса.
		|	ТаблицаИдентификаторы.ПубличныйИдентификатор КАК ПубличныйИдентификатор,
		|	ТаблицаИдентификаторы.Идентификатор КАК Идентификатор,
		|	ТаблицаИдентификаторы.Ссылка КАК Ссылка,
		|	Т.ПометкаУдаления КАК ПометкаУдаления,
		|	Т.Проведен КАК Проведен,
		|	Т.Номер КАК Номер,
		|	Т.Дата КАК Дата,
		|	""Без операции"" КАК ВидОперации,
		|	Т.СуммаДокумента КАК СуммаДокумента,
		|	ПРЕДСТАВЛЕНИЕ(Т.Ссылка) КАК Представление,
		|	""Закупки"" КАК РазделУчета,
		|	Т.Организация КАК Организация,
		// Дополнительные поля данных объекта.
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(Т.Контрагент) КАК Контрагент_GUID,
		|	Т.НомерВходящегоДокумента КАК НомерВходящегоДокумента,
		|	Т.ДатаВходящегоДокумента КАК ДатаВходящегоДокумента,
		|	Т.СуммаНДСДокумента КАК СуммаНДС,
		|	Т.Контрагент.ОбособленноеПодразделение КАК Контрагент_ОбособленноеПодразделение
		|ИЗ
		|	ТаблицаИдентификаторы КАК ТаблицаИдентификаторы
		|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.СчетФактураПолученный КАК Т
		|		ПО (Т.Ссылка = ТаблицаИдентификаторы.Ссылка)");
		Запрос.МенеджерВременныхТаблиц = МенеджерВТ;
		
		ИсточникДанных = Запрос.Выполнить();
		ПоляДанныхОбъекта = "Контрагент_GUID,Контрагент_ОбособленноеПодразделение,НомерВходящегоДокумента,ДатаВходящегоДокумента,СуммаНДС";
		
	ИначеЕсли ТипСсылки = Тип("ДокументСсылка.КорректировкаПоступления") Тогда
		
		Запрос = Новый Запрос(
		"ВЫБРАТЬ
		|	ТаблицаИдентификаторы.Ссылка КАК Ссылка,
		|	КорректировкаПоступленияТовары.СуммаНДС КАК СуммаНДС
		|ПОМЕСТИТЬ СуммыДокументов
		|ИЗ
		|	ТаблицаИдентификаторы КАК ТаблицаИдентификаторы
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.КорректировкаПоступления.Товары КАК КорректировкаПоступленияТовары
		|		ПО ТаблицаИдентификаторы.Ссылка = КорректировкаПоступленияТовары.Ссылка
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ТаблицаИдентификаторы.Ссылка,
		|	КорректировкаПоступленияУслуги.СуммаНДС
		|ИЗ
		|	ТаблицаИдентификаторы КАК ТаблицаИдентификаторы
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.КорректировкаПоступления.Услуги КАК КорректировкаПоступленияУслуги
		|		ПО ТаблицаИдентификаторы.Ссылка = КорректировкаПоступленияУслуги.Ссылка
		|
		|ОБЪЕДИНИТЬ ВСЕ
		|
		|ВЫБРАТЬ
		|	ТаблицаИдентификаторы.Ссылка,
		|	КорректировкаПоступленияАгентскиеУслуги.СуммаНДС
		|ИЗ
		|	ТаблицаИдентификаторы КАК ТаблицаИдентификаторы
		|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Документ.КорректировкаПоступления.АгентскиеУслуги КАК КорректировкаПоступленияАгентскиеУслуги
		|		ПО ТаблицаИдентификаторы.Ссылка = КорректировкаПоступленияАгентскиеУслуги.Ссылка
		|;
		|
		|////////////////////////////////////////////////////////////////////////////////
		|ВЫБРАТЬ
		|	ТаблицаИдентификаторы.ПубличныйИдентификатор КАК ПубличныйИдентификатор,
		|	ТаблицаИдентификаторы.Идентификатор КАК Идентификатор,
		|	ТаблицаИдентификаторы.Ссылка КАК Ссылка,
		|	КорректировкаПоступления.ПометкаУдаления КАК ПометкаУдаления,
		|	КорректировкаПоступления.Проведен КАК Проведен,
		|	КорректировкаПоступления.Номер КАК Номер,
		|	КорректировкаПоступления.Дата КАК Дата,
		|	ПРЕДСТАВЛЕНИЕ(КорректировкаПоступления.ВидОперации) КАК ВидОперации,
		|	КорректировкаПоступления.СуммаДокумента КАК СуммаДокумента,
		|	ПРЕДСТАВЛЕНИЕ(КорректировкаПоступления.Ссылка) КАК Представление,
		|	""Закупки"" КАК РазделУчета,
		|	КорректировкаПоступления.Организация КАК Организация,
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(КорректировкаПоступления.Контрагент) КАК Контрагент_GUID,
		|	КорректировкаПоступления.НомерВходящегоДокумента КАК НомерВходящегоДокумента,
		|	КорректировкаПоступления.ДатаВходящегоДокумента КАК ДатаВходящегоДокумента,
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(КорректировкаПоступления.Склад) КАК Склад_GUID,
		|	КорректировкаПоступления.Контрагент.ОбособленноеПодразделение КАК Контрагент_ОбособленноеПодразделение,
		|	СУММА(ЕСТЬNULL(СуммыДокументов.СуммаНДС, 0)) КАК СуммаНДС
		|ИЗ
		|	ТаблицаИдентификаторы КАК ТаблицаИдентификаторы
		|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.КорректировкаПоступления КАК КорректировкаПоступления
		|		ПО (КорректировкаПоступления.Ссылка = ТаблицаИдентификаторы.Ссылка)
		|		ЛЕВОЕ СОЕДИНЕНИЕ СуммыДокументов КАК СуммыДокументов
		|		ПО (СуммыДокументов.Ссылка = ТаблицаИдентификаторы.Ссылка)
		|
		|СГРУППИРОВАТЬ ПО
		|	ТаблицаИдентификаторы.ПубличныйИдентификатор,
		|	ТаблицаИдентификаторы.Идентификатор,
		|	ТаблицаИдентификаторы.Ссылка,
		|	КорректировкаПоступления.ПометкаУдаления,
		|	КорректировкаПоступления.Проведен,
		|	КорректировкаПоступления.Номер,
		|	КорректировкаПоступления.Дата,
		|	КорректировкаПоступления.СуммаДокумента,
		|	КорректировкаПоступления.Организация,
		|	КорректировкаПоступления.НомерВходящегоДокумента,
		|	КорректировкаПоступления.ДатаВходящегоДокумента,
		|	КорректировкаПоступления.Контрагент.ОбособленноеПодразделение,
		|	ПРЕДСТАВЛЕНИЕ(КорректировкаПоступления.ВидОперации),
		|	ПРЕДСТАВЛЕНИЕ(КорректировкаПоступления.Ссылка),
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(КорректировкаПоступления.Контрагент),
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(КорректировкаПоступления.Склад)");
		Запрос.МенеджерВременныхТаблиц = МенеджерВТ;
		
		ИсточникДанных = Запрос.Выполнить();
		ПоляДанныхОбъекта = "Контрагент_GUID,Склад_GUID,Контрагент_ОбособленноеПодразделение,НомерВходящегоДокумента,ДатаВходящегоДокумента,СуммаНДС";
		
	ИначеЕсли ТипСсылки = Тип("ДокументСсылка.ПоступлениеДопРасходов") Тогда
		
		Запрос = Новый Запрос(
		"ВЫБРАТЬ
		|	ТаблицаИдентификаторы.ПубличныйИдентификатор КАК ПубличныйИдентификатор,
		|	ТаблицаИдентификаторы.Идентификатор КАК Идентификатор,
		|	ТаблицаИдентификаторы.Ссылка КАК Ссылка,
		|	Т.ПометкаУдаления КАК ПометкаУдаления,
		|	Т.Проведен КАК Проведен,
		|	Т.Номер КАК Номер,
		|	Т.Дата КАК Дата,
		|	""Без операции"" КАК ВидОперации,
		|	Т.СуммаДокумента КАК СуммаДокумента,
		|	ПРЕДСТАВЛЕНИЕ(МАКСИМУМ(Т.Ссылка)) КАК Представление,
		|	""Закупки"" КАК РазделУчета,
		|	Т.Организация КАК Организация,
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(Т.Контрагент) КАК Контрагент_GUID,
		|	Т.НомерВходящегоДокумента КАК НомерВходящегоДокумента,
		|	Т.ДатаВходящегоДокумента КАК ДатаВходящегоДокумента,
		|	Т.Контрагент.ОбособленноеПодразделение КАК Контрагент_ОбособленноеПодразделение,
		|	СУММА(ЕСТЬNULL(ТЧ1.СуммаНДС, 0)) КАК СуммаНДС
		|ИЗ
		|	ТаблицаИдентификаторы КАК ТаблицаИдентификаторы
		|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ПоступлениеДопРасходов КАК Т
		|			ЛЕВОЕ СОЕДИНЕНИЕ Документ.ПоступлениеДопРасходов.Товары КАК ТЧ1
		|			ПО Т.Ссылка = ТЧ1.Ссылка
		|		ПО (Т.Ссылка = ТаблицаИдентификаторы.Ссылка)
		|
		|СГРУППИРОВАТЬ ПО
		|	ТаблицаИдентификаторы.ПубличныйИдентификатор,
		|	ТаблицаИдентификаторы.Идентификатор,
		|	ТаблицаИдентификаторы.Ссылка,
		|	Т.ПометкаУдаления,
		|	Т.Проведен,
		|	Т.Номер,
		|	Т.Дата,
		|	Т.СуммаДокумента,
		|	Т.Организация,
		|	Т.НомерВходящегоДокумента,
		|	Т.ДатаВходящегоДокумента,
		|	Т.Контрагент.ОбособленноеПодразделение,
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(Т.Контрагент)");
		Запрос.МенеджерВременныхТаблиц = МенеджерВТ;
		
		ИсточникДанных = Запрос.Выполнить();
		ПоляДанныхОбъекта = "Контрагент_GUID,Контрагент_ОбособленноеПодразделение,НомерВходящегоДокумента,ДатаВходящегоДокумента,СуммаНДС";
		
	ИначеЕсли ТипСсылки = Тип("ДокументСсылка.ОтчетКомитентуОПродажах") Тогда
		
		Запрос = Новый Запрос(
		"ВЫБРАТЬ
		|	ТаблицаИдентификаторы.ПубличныйИдентификатор КАК ПубличныйИдентификатор,
		|	ТаблицаИдентификаторы.Идентификатор КАК Идентификатор,
		|	ТаблицаИдентификаторы.Ссылка КАК Ссылка,
		|	Т.ПометкаУдаления КАК ПометкаУдаления,
		|	Т.Проведен КАК Проведен,
		|	Т.Номер КАК Номер,
		|	Т.Дата КАК Дата,
		|	ПРЕДСТАВЛЕНИЕ(Т.ВидОперации) КАК ВидОперации,
		|	Т.СуммаДокумента КАК СуммаДокумента,
		|	ПРЕДСТАВЛЕНИЕ(МАКСИМУМ(Т.Ссылка)) КАК Представление,
		|	""Закупки"" КАК РазделУчета,
		|	Т.Организация КАК Организация,
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(Т.Контрагент) КАК Контрагент_GUID,
		|	Т.Контрагент.ОбособленноеПодразделение КАК Контрагент_ОбособленноеПодразделение,
		|	СУММА(ЕСТЬNULL(ТЧ1.СуммаНДС, 0)) КАК СуммаНДС,
		|	Т.СпособРасчетаКомиссионногоВознаграждения КАК СпособРасчетаКомиссионногоВознаграждения,
		|	Т.ПроцентКомиссионногоВознаграждения КАК ПроцентКомиссионногоВознаграждения,
		|	Т.СуммаВознаграждения КАК СуммаВознаграждения,
		|	Т.СтавкаНДСВознаграждения КАК СтавкаНДСВознаграждения
		|ИЗ
		|	ТаблицаИдентификаторы КАК ТаблицаИдентификаторы
		|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ОтчетКомитентуОПродажах КАК Т
		|			ЛЕВОЕ СОЕДИНЕНИЕ Документ.ОтчетКомитентуОПродажах.Товары КАК ТЧ1
		|			ПО Т.Ссылка = ТЧ1.Ссылка
		|		ПО (Т.Ссылка = ТаблицаИдентификаторы.Ссылка)
		|
		|СГРУППИРОВАТЬ ПО
		|	ТаблицаИдентификаторы.ПубличныйИдентификатор,
		|	ТаблицаИдентификаторы.Идентификатор,
		|	ТаблицаИдентификаторы.Ссылка,
		|	Т.ПометкаУдаления,
		|	Т.Проведен,
		|	Т.Номер,
		|	Т.Дата,
		|	Т.СуммаДокумента,
		|	Т.Организация,
		|	Т.Контрагент.ОбособленноеПодразделение,
		|	Т.СпособРасчетаКомиссионногоВознаграждения,
		|	Т.ПроцентКомиссионногоВознаграждения,
		|	Т.СуммаВознаграждения,
		|	Т.СтавкаНДСВознаграждения,
		|	ПРЕДСТАВЛЕНИЕ(Т.ВидОперации),
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(Т.Контрагент)");
		Запрос.МенеджерВременныхТаблиц = МенеджерВТ;
		
		ИсточникДанных = Запрос.Выполнить();
		ПоляДанныхОбъекта = "Контрагент_GUID,Контрагент_ОбособленноеПодразделение,СуммаНДС,СпособРасчетаКомиссионногоВознаграждения,ПроцентКомиссионногоВознаграждения,СуммаВознаграждения,СтавкаНДСВознаграждения";
		
	// Склад	
	ИначеЕсли ТипСсылки = Тип("ДокументСсылка.ПеремещениеТоваров") Тогда
		
		Запрос = Новый Запрос(
		"ВЫБРАТЬ
		// Обязательные поля запроса.
		|	ТаблицаИдентификаторы.ПубличныйИдентификатор КАК ПубличныйИдентификатор,
		|	ТаблицаИдентификаторы.Идентификатор КАК Идентификатор,
		|	ТаблицаИдентификаторы.Ссылка КАК Ссылка,
		|	Т.ПометкаУдаления КАК ПометкаУдаления,
		|	Т.Проведен КАК Проведен,
		|	Т.Номер КАК Номер,
		|	Т.Дата КАК Дата,
		|	ПРЕДСТАВЛЕНИЕ(Т.ВидОперации) КАК ВидОперации,
		|	0 КАК СуммаДокумента,
		|	ПРЕДСТАВЛЕНИЕ(Т.Ссылка) КАК Представление,
		|	""Склад"" КАК РазделУчета,
		|	Т.Организация КАК Организация,
		// Дополнительные поля данных объекта.
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(Т.СкладОтправитель) КАК Склад_GUID,
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(Т.СкладПолучатель) КАК СкладПолучатель_GUID
		|ИЗ
		|	ТаблицаИдентификаторы КАК ТаблицаИдентификаторы
		|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ПеремещениеТоваров КАК Т
		|		ПО (Т.Ссылка = ТаблицаИдентификаторы.Ссылка)");
		Запрос.МенеджерВременныхТаблиц = МенеджерВТ;
		
		ИсточникДанных = Запрос.Выполнить();
		ПоляДанныхОбъекта = "Склад_GUID,СкладПолучатель_GUID";
		
	ИначеЕсли ТипСсылки = Тип("ДокументСсылка.ПередачаМатериаловВЭксплуатацию") Тогда
		
		Запрос = Новый Запрос(
		"ВЫБРАТЬ
		// Обязательные поля запроса.
		|	ТаблицаИдентификаторы.ПубличныйИдентификатор КАК ПубличныйИдентификатор,
		|	ТаблицаИдентификаторы.Идентификатор КАК Идентификатор,
		|	ТаблицаИдентификаторы.Ссылка КАК Ссылка,
		|	Т.ПометкаУдаления КАК ПометкаУдаления,
		|	Т.Проведен КАК Проведен,
		|	Т.Номер КАК Номер,
		|	Т.Дата КАК Дата,
		|	""Без операции"" КАК ВидОперации,
		|	0 КАК СуммаДокумента,
		|	ПРЕДСТАВЛЕНИЕ(Т.Ссылка) КАК Представление,
		|	""Склад"" КАК РазделУчета,
		|	Т.Организация КАК Организация,
		// Дополнительные поля данных объекта.
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(Т.Склад) КАК Склад_GUID
		|ИЗ
		|	ТаблицаИдентификаторы КАК ТаблицаИдентификаторы
		|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ПередачаМатериаловВЭксплуатацию КАК Т
		|		ПО (Т.Ссылка = ТаблицаИдентификаторы.Ссылка)");
		Запрос.МенеджерВременныхТаблиц = МенеджерВТ;
		
		ИсточникДанных = Запрос.Выполнить();
		ПоляДанныхОбъекта = "Склад_GUID,";

	ИначеЕсли ТипСсылки = Тип("ДокументСсылка.ВозвратМатериаловИзЭксплуатации") Тогда
		
		Запрос = Новый Запрос(
		"ВЫБРАТЬ
		// Обязательные поля запроса.
		|	ТаблицаИдентификаторы.ПубличныйИдентификатор КАК ПубличныйИдентификатор,
		|	ТаблицаИдентификаторы.Идентификатор КАК Идентификатор,
		|	ТаблицаИдентификаторы.Ссылка КАК Ссылка,
		|	Т.ПометкаУдаления КАК ПометкаУдаления,
		|	Т.Проведен КАК Проведен,
		|	Т.Номер КАК Номер,
		|	Т.Дата КАК Дата,
		|	""Без операции"" КАК ВидОперации,
		|	0 КАК СуммаДокумента,
		|	ПРЕДСТАВЛЕНИЕ(Т.Ссылка) КАК Представление,
		|	""Склад"" КАК РазделУчета,
		|	Т.Организация КАК Организация,
		// Дополнительные поля данных объекта.
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(Т.Склад) КАК Склад_GUID
		|ИЗ
		|	ТаблицаИдентификаторы КАК ТаблицаИдентификаторы
		|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ВозвратМатериаловИзЭксплуатации КАК Т
		|		ПО (Т.Ссылка = ТаблицаИдентификаторы.Ссылка)");
		Запрос.МенеджерВременныхТаблиц = МенеджерВТ;
		
		ИсточникДанных = Запрос.Выполнить();
		ПоляДанныхОбъекта = "Склад_GUID,";
		
	ИначеЕсли ТипСсылки = Тип("ДокументСсылка.ИнвентаризацияТоваровНаСкладе") Тогда
		
		Запрос = Новый Запрос(
		"ВЫБРАТЬ
		// Обязательные поля запроса.
		|	ТаблицаИдентификаторы.ПубличныйИдентификатор КАК ПубличныйИдентификатор,
		|	ТаблицаИдентификаторы.Идентификатор КАК Идентификатор,
		|	ТаблицаИдентификаторы.Ссылка КАК Ссылка,
		|	Т.ПометкаУдаления КАК ПометкаУдаления,
		|	Т.Проведен КАК Проведен,
		|	Т.Номер КАК Номер,
		|	Т.Дата КАК Дата,
		|	""Без операции"" КАК ВидОперации,
		|	0 КАК СуммаДокумента,
		|	ПРЕДСТАВЛЕНИЕ(Т.Ссылка) КАК Представление,
		|	""Склад"" КАК РазделУчета,
		|	Т.Организация КАК Организация,
		// Дополнительные поля данных объекта.
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(Т.Склад) КАК Склад_GUID
		|ИЗ
		|	ТаблицаИдентификаторы КАК ТаблицаИдентификаторы
		|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ИнвентаризацияТоваровНаСкладе КАК Т
		|		ПО (Т.Ссылка = ТаблицаИдентификаторы.Ссылка)");
		Запрос.МенеджерВременныхТаблиц = МенеджерВТ;
		
		ИсточникДанных = Запрос.Выполнить();
		ПоляДанныхОбъекта = "Склад_GUID";
		
		
	ИначеЕсли ТипСсылки = Тип("ДокументСсылка.ОприходованиеТоваров") Тогда
		
		Запрос = Новый Запрос(
		"ВЫБРАТЬ
		// Обязательные поля запроса.
		|	ТаблицаИдентификаторы.ПубличныйИдентификатор КАК ПубличныйИдентификатор,
		|	ТаблицаИдентификаторы.Идентификатор КАК Идентификатор,
		|	ТаблицаИдентификаторы.Ссылка КАК Ссылка,
		|	Т.ПометкаУдаления КАК ПометкаУдаления,
		|	Т.Проведен КАК Проведен,
		|	Т.Номер КАК Номер,
		|	Т.Дата КАК Дата,
		|	""Без операции"" КАК ВидОперации,
		|	Т.СуммаДокумента КАК СуммаДокумента,
		|	ПРЕДСТАВЛЕНИЕ(Т.Ссылка) КАК Представление,
		|	""Склад"" КАК РазделУчета,
		|	Т.Организация КАК Организация,
		// Дополнительные поля данных объекта.
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(Т.Склад) КАК Склад_GUID
		|ИЗ
		|	ТаблицаИдентификаторы КАК ТаблицаИдентификаторы
		|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ОприходованиеТоваров КАК Т
		|		ПО (Т.Ссылка = ТаблицаИдентификаторы.Ссылка)");
		Запрос.МенеджерВременныхТаблиц = МенеджерВТ;
		
		ИсточникДанных = Запрос.Выполнить();
		ПоляДанныхОбъекта = "Склад_GUID";
		
		
	ИначеЕсли ТипСсылки = Тип("ДокументСсылка.КомплектацияНоменклатуры") Тогда
		
		Запрос = Новый Запрос(
		"ВЫБРАТЬ
		// Обязательные поля запроса.
		|	ТаблицаИдентификаторы.ПубличныйИдентификатор КАК ПубличныйИдентификатор,
		|	ТаблицаИдентификаторы.Идентификатор КАК Идентификатор,
		|	ТаблицаИдентификаторы.Ссылка КАК Ссылка,
		|	Т.ПометкаУдаления КАК ПометкаУдаления,
		|	Т.Проведен КАК Проведен,
		|	Т.Номер КАК Номер,
		|	Т.Дата КАК Дата,
		|	ПРЕДСТАВЛЕНИЕ(Т.ВидОперации) КАК ВидОперации,
		|	0 КАК СуммаДокумента,
		|	ПРЕДСТАВЛЕНИЕ(Т.Ссылка) КАК Представление,
		|	""Прочее"" КАК РазделУчета,
		|	Т.Организация КАК Организация,
		// Дополнительные поля данных объекта.
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(Т.Склад) КАК Склад_GUID
		|ИЗ
		|	ТаблицаИдентификаторы КАК ТаблицаИдентификаторы
		|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.КомплектацияНоменклатуры КАК Т
		|		ПО (Т.Ссылка = ТаблицаИдентификаторы.Ссылка)");
		Запрос.МенеджерВременныхТаблиц = МенеджерВТ;
		
		ИсточникДанных = Запрос.Выполнить();
		ПоляДанныхОбъекта = "Склад_GUID";
		
		
	ИначеЕсли ТипСсылки = Тип("ДокументСсылка.ОтчетПроизводстваЗаСмену") Тогда
		
		Запрос = Новый Запрос(
		"ВЫБРАТЬ
		// Обязательные поля запроса.
		|	ТаблицаИдентификаторы.ПубличныйИдентификатор КАК ПубличныйИдентификатор,
		|	ТаблицаИдентификаторы.Идентификатор КАК Идентификатор,
		|	ТаблицаИдентификаторы.Ссылка КАК Ссылка,
		|	Т.ПометкаУдаления КАК ПометкаУдаления,
		|	Т.Проведен КАК Проведен,
		|	Т.Номер КАК Номер,
		|	Т.Дата КАК Дата,
		|	ПРЕДСТАВЛЕНИЕ(Т.ВидОперации) КАК ВидОперации,
		|	0 КАК СуммаДокумента,
		|	ПРЕДСТАВЛЕНИЕ(Т.Ссылка) КАК Представление,
		|	""Прочее"" КАК РазделУчета,
		|	Т.Организация КАК Организация,
		// Дополнительные поля данных объекта.
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(Т.Склад) КАК Склад_GUID
		|ИЗ
		|	ТаблицаИдентификаторы КАК ТаблицаИдентификаторы
		|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ОтчетПроизводстваЗаСмену КАК Т
		|		ПО (Т.Ссылка = ТаблицаИдентификаторы.Ссылка)");
		Запрос.МенеджерВременныхТаблиц = МенеджерВТ;
		
		ИсточникДанных = Запрос.Выполнить();
		ПоляДанныхОбъекта = "Склад_GUID";
		
		
	ИначеЕсли ТипСсылки = Тип("ДокументСсылка.РеализацияУслугПоПереработке") Тогда
		
		Запрос = Новый Запрос(
		"ВЫБРАТЬ
		|	ТаблицаИдентификаторы.ПубличныйИдентификатор КАК ПубличныйИдентификатор,
		|	ТаблицаИдентификаторы.Идентификатор КАК Идентификатор,
		|	ТаблицаИдентификаторы.Ссылка КАК Ссылка,
		|	Т.ПометкаУдаления КАК ПометкаУдаления,
		|	Т.Проведен КАК Проведен,
		|	Т.Номер КАК Номер,
		|	Т.Дата КАК Дата,
		|	""Без операции"" КАК ВидОперации,
		|	0 КАК СуммаДокумента,
		|	ПРЕДСТАВЛЕНИЕ(МАКСИМУМ(Т.Ссылка)) КАК Представление,
		|	""Прочее"" КАК РазделУчета,
		|	Т.Организация КАК Организация,
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(Т.Контрагент) КАК Контрагент_GUID,
		|	Т.Контрагент.ОбособленноеПодразделение КАК Контрагент_ОбособленноеПодразделение,
		|	СУММА(ЕСТЬNULL(ТЧ1.СуммаНДС, 0)) КАК СуммаНДС
		|ИЗ
		|	ТаблицаИдентификаторы КАК ТаблицаИдентификаторы
		|		ЛЕВОЕ СОЕДИНЕНИЕ Документ.РеализацияУслугПоПереработке КАК Т
		|			ЛЕВОЕ СОЕДИНЕНИЕ Документ.РеализацияУслугПоПереработке.Услуги КАК ТЧ1
		|			ПО Т.Ссылка = ТЧ1.Ссылка
		|		ПО (Т.Ссылка = ТаблицаИдентификаторы.Ссылка)
		|
		|СГРУППИРОВАТЬ ПО
		|	ТаблицаИдентификаторы.ПубличныйИдентификатор,
		|	ТаблицаИдентификаторы.Идентификатор,
		|	ТаблицаИдентификаторы.Ссылка,
		|	Т.ПометкаУдаления,
		|	Т.Проведен,
		|	Т.Номер,
		|	Т.Дата,
		|	Т.Организация,
		|	Т.Контрагент.ОбособленноеПодразделение,
		|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(Т.Контрагент)");
		Запрос.МенеджерВременныхТаблиц = МенеджерВТ;
		
		ИсточникДанных = Запрос.Выполнить();
		ПоляДанныхОбъекта = "Контрагент_GUID,Контрагент_ОбособленноеПодразделение,СуммаНДС";
		
	КонецЕсли;
	
КонецПроцедуры

Процедура ПриЗаписиСинхронизируемогоОбъекта(Источник, СсылкиДляРегистрации, СтандартнаяОбработка) Экспорт
	
	
КонецПроцедуры

#КонецОбласти