// @strict-types

#Область СлужебныйПрограммныйИнтерфейс

#Область Словарь

// Внутренняя ошибка сервиса.
// 
// Возвращаемое значение:
//  Строка - Внутренняя ошибка сервиса
Функция ВнутренняяОшибкаСервиса() Экспорт
	Возврат НСтр("ru = 'Внутренняя ошибка сервиса.'");
КонецФункции

// Имя сервиса.
// 
// Возвращаемое значение:
//  Строка - Имя сервиса
Функция ИмяСервиса() Экспорт
	Возврат "ИнтеграцияBnovo.СервисИнтеграции";
КонецФункции

// Метод обновить токен доступа.
// 
// Возвращаемое значение:
//  Строка - Метод обновить токен доступа
Функция МетодОбновитьТокенДоступа() Экспорт
	Возврат "ОбновитьТокенДоступа";
КонецФункции 

// Установить соединение с сервисом интеграции.
// 
// Возвращаемое значение:
//  Строка - Установить соединение с сервисом интеграции
Функция МетодУстановитьСоединение() Экспорт
	Возврат "УстановитьСоединение";
КонецФункции

// Метод получить состояние подключения с сервисом интеграции.
// 
// Возвращаемое значение:
//  Строка - Метод получить состояние подключения с сервисом интеграции
Функция МетодПолучитьСостояниеПодключенияССервисомИнтеграции() Экспорт
	Возврат "ПолучитьСостояниеПодключения";
КонецФункции

// Метод создать обновить учетную запись.
// 
// Возвращаемое значение:
//  Строка - Метод создать обновить учетную запись
Функция МетодСоздатьОбновитьУчетнуюЗапись() Экспорт
	Возврат "СоздатьОбновитьУчетнуюЗапись";
КонецФункции

Функция МетодПолучитьБронирования() Экспорт
	Возврат "ПолучитьБронирования";
КонецФункции 

Функция МетодПолучитьПроживания() Экспорт
	Возврат "ПолучитьПроживания";
КонецФункции 

Функция МетодПолучитьПлатежи() Экспорт
	Возврат "ПолучитьПлатежи";
КонецФункции 


// Метод завершение менеджер длительных операций.
// 
// Возвращаемое значение:
//  Строка - Метод завершение менеджер длительных операций
Функция МетодЗавершениеМенеджерДлительныхОпераций() Экспорт
	Возврат "ЗавершениеМенеджерДлительныхОпераций";
КонецФункции

// Имя метода общего модуля получения учетных записей в сервисе интеграции
// 
// Возвращаемое значение:
//  Строка - имя метода
Функция МетодПолучитьУчетныеЗаписи() Экспорт
	Возврат "ПолучитьУчетныеЗаписи";
КонецФункции

// Метод удалить учетную запись.
// 
// Возвращаемое значение:
//  Строка - Метод удалить учетную запись
Функция МетодУдалитьУчетнуюЗапись() Экспорт
	Возврат "УдалитьУчетнуюЗапись";
КонецФункции

// Имя метода общего модуля обновления настроек учетной записи в сервисе интеграции
// 
// Возвращаемое значение:
//  Строка - имя метода
Функция МетодОбновитьНастройкиУчетнойЗаписи() Экспорт
	Возврат "ОбновитьНастройкиУчетнойЗаписи";
КонецФункции

// Метод получить данные пользователя ИТС.
// 
// Возвращаемое значение:
//  Строка - Метод получить данные пользователя ИТС
Функция МетодПолучитьДанныеПользователяИТС() Экспорт
	Возврат "ПолучитьДанныеПользователяИТС";
КонецФункции

// Метод получить список подключений.
// 
// Возвращаемое значение:
//  Строка - Получить список подключений
Функция МетодПолучитьПодключения() Экспорт
	Возврат "ПолучитьПодключения";
КонецФункции

// Метод установить подключение.
// 
// Возвращаемое значение:
//  Строка - Метод установить подключение
Функция МетодУстановитьПодключение() Экспорт
	Возврат "УстановитьПодключение";
КонецФункции

// Метод удалить подключение.
// 
// Возвращаемое значение:
//  Строка - Метод удалить подключение
Функция МетодУдалитьПодключение() Экспорт
	Возврат "УдалитьПодключение";
КонецФункции

// Имя метода ping
// 
// Возвращаемое значение:
//  Строка - Имя метода проверки доступности сервиса интеграции
Функция МетодПроверитьДоступностьСервисаИнтеграции() Экспорт
	Возврат "ПроверитьДоступностьСервисаИнтеграции";
КонецФункции

#КонецОбласти

#Область Конструкторы

#Область КонструкторыКарточекОбъектовСервисаИнтеграции

// Новый описание токена.
// 
// Возвращаемое значение:
//  Структура - Новый описание токена:
// * Токен - Строка - 
// * Ошибка - Строка - 
Функция НовыйОписаниеТокена() Экспорт
	
	Результат = Новый Структура;
	
	Результат.Вставить("Токен", "");
	Результат.Вставить("Ошибка", "");
	
	Возврат Результат;
	
КонецФункции

#КонецОбласти

#Область КонструкторыЗапросов

// Новые служебные параметры запроса.
// 
// Возвращаемое значение:
//  Структура - Новые служебные параметры запроса:
// * ИмяМетода - Строка - Имя метода
// * ВыводитьСообщения - Булево - Признак вывода сообщений в ходе выполнения метода на экран
Функция НовыеСлужебныеПараметрыЗапроса() Экспорт
	
	Параметры = Новый Структура;
	
	Параметры.Вставить("ИмяМетода", "");
	Параметры.Вставить("ВыводитьСообщения", Ложь);
	
	Возврат Параметры
	
КонецФункции

// Инициализация параметров запроса "ОбновитьТокенДоступа".
// 
// Возвращаемое значение:
//  Структура - Новые параметры обновить токен доступа:
// * id_token - Строка - Токен доступа
// * client_id - Строка - Публичная часть ключа доступа
// * client_secret - Строка - Секретная часть ключа доступа
// * ДатаОбновленияТокена - Дата - Дата обновления токена доступа
Функция НовыеПараметрыОбновитьТокенДоступа() Экспорт
	
	Параметры = НовыеСлужебныеПараметрыЗапроса();
	Параметры.ИмяМетода = МетодОбновитьТокенДоступа();
	
	Параметры.Вставить("id_token", "");
	Параметры.Вставить("client_id", "");
	Параметры.Вставить("client_secret", "");
	Параметры.Вставить("ДатаОбновленияТокена", Дата(1,1,1));
	
	Возврат Параметры;
	
КонецФункции

// Инициализация параметров запроса "ПолучитьПодключения".
// 
// Возвращаемое значение:
//  См. НовыеСлужебныеПараметрыЗапроса
Функция НовыеПараметрыПолучитьПодключения() Экспорт
	Параметры = НовыеСлужебныеПараметрыЗапроса();
	Параметры.ИмяМетода = ИнтеграцияBnovoСИКлиентСервер.МетодПолучитьПодключения();
	Возврат Параметры;
КонецФункции   

// Инициализация параметров запроса к серверами BNovo
// 
// Возвращаемое значение:
//  См. НовыеСлужебныеПараметрыЗапроса
Функция НовыеПараметрыЗапросBNovo() Экспорт
	Параметры = НовыеСлужебныеПараметрыЗапроса();
	Параметры.ИмяМетода = МетодСоздатьОбновитьУчетнуюЗапись();
	Параметры.Вставить("КлючПодключения");
	Параметры.Вставить("ИдентификаторИнформационнойБазы");
	Параметры.Вставить("УчетнаяЗапись");
	Параметры.Вставить("ApiKey");
	Параметры.Вставить("ДатаНачалаЗагрузки");
	Возврат Параметры;
КонецФункции

Функция НовыеПараметрыПолучитьБронирования(Период) Экспорт
	Параметры = НовыеСлужебныеПараметрыЗапроса();
	Параметры.ИмяМетода = МетодПолучитьБронирования();
	
	Параметры.Вставить("ДатаНачала",    
		Формат(ОбщегоНазначенияКлиентСервер.СвойствоСтруктуры(Период,"ДатаНачала"), "ДФ=yyyy-MM-dd"));
	Параметры.Вставить("ДатаОкончания", 
		Формат(ОбщегоНазначенияКлиентСервер.СвойствоСтруктуры(Период,"ДатаОкончания"), "ДФ=yyyy-MM-dd"));
		
	Параметры.Вставить("Новые",         Период = Неопределено);
	Параметры.Вставить("УчетнаяЗапись");
	
	Возврат Параметры;
КонецФункции

Функция НовыеПараметрыПолучитьПроживания(Период) Экспорт
	Параметры = НовыеСлужебныеПараметрыЗапроса();
	Параметры.ИмяМетода = МетодПолучитьПроживания();
	
	Параметры.Вставить("ДатаНачала",    
		Формат(ОбщегоНазначенияКлиентСервер.СвойствоСтруктуры(Период,"ДатаНачала"), "ДФ=yyyy-MM-dd"));
	Параметры.Вставить("ДатаОкончания", 
		Формат(ОбщегоНазначенияКлиентСервер.СвойствоСтруктуры(Период,"ДатаОкончания"), "ДФ=yyyy-MM-dd"));
		
	Параметры.Вставить("Новые",         Период = Неопределено);
	Параметры.Вставить("УчетнаяЗапись");
	
	Возврат Параметры;
КонецФункции 

Функция НовыеПараметрыПолучитьПлатежи(Период) Экспорт
	Параметры = НовыеСлужебныеПараметрыЗапроса();
	Параметры.ИмяМетода = МетодПолучитьПлатежи();
	
	Параметры.Вставить("ДатаНачала",    
		Формат(ОбщегоНазначенияКлиентСервер.СвойствоСтруктуры(Период,"ДатаНачала"), "ДФ=yyyy-MM-dd"));
	Параметры.Вставить("ДатаОкончания", 
		Формат(ОбщегоНазначенияКлиентСервер.СвойствоСтруктуры(Период,"ДатаОкончания"), "ДФ=yyyy-MM-dd"));
		
	Параметры.Вставить("Новые",         Период = Неопределено);
	Параметры.Вставить("УчетнаяЗапись");
	
	Возврат Параметры;
КонецФункции 


// Новые параметры удалить подключение.
// 
// Возвращаемое значение:
//  Структура - Новые параметры удалить подключение:
// * ДанныеИнтеграции - Структура - 
// * УчетнаяЗапись - Строка - 
// * ИмяМетода - Строка - 
// * ВыводитьСообщения - Булево - 
// * КлючПодключения - Строка - 
// * ЭтоТекущийКлючПодключения - Булево - 
Функция НовыеПараметрыУдалитьПодключение() Экспорт
	
	Параметры = НовыеСлужебныеПараметрыЗапроса();
	Параметры.ИмяМетода = МетодУдалитьПодключение();
	
	Параметры.Вставить("КлючПодключения", "");
	Параметры.Вставить("ЭтоТекущийКлючПодключения", Ложь);
	
	Возврат Параметры;
	
КонецФункции

// Инициализация параметров запроса "УстановитьСоединение".
// 
// Возвращаемое значение:
//  Структура - Новые параметры установить соединение:
// * ИмяМетода - Строка - 
// * ВыводитьСообщения - Булево - 
// * Логин - Строка - 
// * Тикет - Строка - 
// * client_id - Строка - 
// * КлючПодключения - Строка - 
// * Представление - Строка - 
// * ИдентификаторИнформационнойБазы - Строка - 
Функция НовыеПараметрыУстановитьСоединение() Экспорт
	Параметры = НовыеСлужебныеПараметрыЗапроса();
	Параметры.ИмяМетода = МетодУстановитьСоединение();
	
	// логин ИПП
	Параметры.Вставить("Логин",                           "");
	Параметры.Вставить("Тикет",                           "");
	// УИД ИПП
	Параметры.Вставить("client_id",                       "");
	// УИД текущей информационной базы
	Параметры.Вставить("КлючПодключения",                 "");
	
	Параметры.Вставить("Представление",                   НСтр("ru = 'Сервис интеграции Bnovo'"));
	// ИД конретной ИБ
	Параметры.Вставить("ИдентификаторИнформационнойБазы", "");
	
	Возврат Параметры;
КонецФункции

// Инициализация параметров запроса "УстановитьПодключение".
// 
// Возвращаемое значение:
//  Структура - Новые параметры установить соединение:
// * ИмяМетода - Строка - 
// * Логин - Строка - Логин ИПП
// * client_id - Строка - УИД ИПП
// * КлючПодключения - Строка - УИД текущей информационной базы
// * Представление - Строка - 
Функция НовыеПараметрыУстановитьПодключение() Экспорт
	Параметры = НовыеСлужебныеПараметрыЗапроса();
	Параметры.ИмяМетода = МетодУстановитьПодключение();
	
	Параметры.Вставить("Логин",           "");
	Параметры.Вставить("client_id",       "");
	Параметры.Вставить("КлючПодключения", "");
	Параметры.Вставить("Представление",   НСтр("ru = 'Сервис интеграции Bnovo'"));
	
	Возврат Параметры;
КонецФункции


#КонецОбласти

// Новые параметры подключения.
// 
// Возвращаемое значение:
//  Структура - Новые параметры подключения:
// * client_id - Строка - 
// * КлючПодключения - Строка - 
// * ИдентификаторИнформационнойБазы - Строка - 
// * Представление - Строка - 
// * ДатаПодключенияСИ - Дата - 
// * ЭтоНовоеПодключение - Булево - 
Функция НовыеПараметрыПодключения() Экспорт
	
	ПараметрыПодключения = Новый Структура;
	
	ПараметрыПодключения.Вставить("client_id", "");
	ПараметрыПодключения.Вставить("КлючПодключения", "");
	ПараметрыПодключения.Вставить("ИдентификаторИнформационнойБазы", "");
	ПараметрыПодключения.Вставить("Представление", "");
	ПараметрыПодключения.Вставить("ДатаПодключенияСИ", Дата(1, 1, 1));
	ПараметрыПодключения.Вставить("ЭтоНовоеПодключение", Ложь);
	
	Возврат ПараметрыПодключения;
	
КонецФункции

// Новый результат метода.
// 
// Возвращаемое значение:
//  Структура - Новый результат метода:
// * Ошибки - Массив из Строка - описание ошибок, возникших в ходе выполнения метода
// * КодСостояния - Число - Код ответа. https://ru.wikipedia.org/wiki/Список_кодов_состояния_HTTP.
Функция НовыйРезультатМетода() Экспорт
	
	Результат = Новый Структура;
	
	Результат.Вставить("Ошибки", Новый Массив);
	Результат.Вставить("КодСостояния", 0);
	
	Возврат Результат;
	
КонецФункции

#КонецОбласти 

#КонецОбласти