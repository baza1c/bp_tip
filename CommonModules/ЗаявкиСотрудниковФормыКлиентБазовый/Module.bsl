
#Область СлужебныеПроцедурыИФункции

Процедура СоздатьНовыйДокументОтпуск(Форма) Экспорт

	ОткрытьФорму("Документ.Отпуск.Форма.ФормаДокумента", ПараметрыЗаполненияДокументаОтпуск(Форма), Форма);

КонецПроцедуры

Функция ПараметрыЗаполненияДокументаОтпуск(Форма)
	
	Объект = Форма.Объект;
	
	ПараметрыЗаполнения = Новый Структура;
	
	ДанныеЗаполнения = Новый Структура;
	ДанныеЗаполнения.Вставить("Ссылка", 		Неопределено);
	ДанныеЗаполнения.Вставить("Действие", 		"Заполнить");
	ДанныеЗаполнения.Вставить("Сотрудник", 		Объект.Сотрудник);
	ДанныеЗаполнения.Вставить("Организация", 	Объект.Организация);
	
	КоличествоДнейОтпуска = ЗаявкиСотрудниковВызовСервераБазовый.КоличествоДнейОтпуска(Объект.ДатаНачала, Объект.ДатаОкончания, Объект.Организация);
	ДанныеЗаполнения.Вставить("ДатаНачалаОсновногоОтпуска", 	Объект.ДатаНачала);
	ДанныеЗаполнения.Вставить("ДатаОкончанияОсновногоОтпуска", 	Объект.ДатаОкончания);
	ДанныеЗаполнения.Вставить("КоличествоДнейОсновногоОтпуска", КоличествоДнейОтпуска);
	
	ПараметрыЗаполнения.Вставить("Основание", ДанныеЗаполнения);
		
	Возврат ПараметрыЗаполнения;
	
КонецФункции

Функция ПараметрыЗаполненияДокументаОтпускБезОплаты(Форма) Экспорт
	
	Объект = Форма.Объект;
	
	ПараметрыЗаполнения = Новый Структура("Основание");
	
	ДанныеЗаполнения = Новый Структура;
	ДанныеЗаполнения.Вставить("Ссылка", 		Неопределено);
	ДанныеЗаполнения.Вставить("Действие", 		"Заполнить");
	ДанныеЗаполнения.Вставить("Сотрудник", 		Объект.Сотрудник);
	ДанныеЗаполнения.Вставить("Организация", 	Объект.Организация);
	ДанныеЗаполнения.Вставить("ДатаНачала", 	Объект.ДатаНачала);
	ДанныеЗаполнения.Вставить("ДатаОкончания", 	Объект.ДатаОкончания);
	
	ПараметрыЗаполнения.Основание = ДанныеЗаполнения;
		
	Возврат ПараметрыЗаполнения;

КонецФункции

Процедура СоздатьНовыйДокументПоОтсутствию(Форма) Экспорт
	
	ПричинаНетрудоспособности = Неопределено;
	Если Форма.Объект.ПричинаОтсутствия = ПредопределенноеЗначение("Перечисление.ПричиныОтсутствийЗаявокКабинетСотрудника.ОтпускПоБеременностиИРодам") Тогда
		ПричинаНетрудоспособности = ПредопределенноеЗначение("Перечисление.ПричиныНетрудоспособности.ПоБеременностиИРодам");
	КонецЕсли;
	ОткрытьФорму("Документ.БольничныйЛист.ФормаОбъекта", ПараметрыЗаполненияБольничныйЛист(Форма), Форма);
	
КонецПроцедуры

Функция ПараметрыЗаполненияБольничныйЛист(Форма, ПричинаНетрудоспособности = Неопределено) Экспорт
	
	Объект = Форма.Объект;
	
	ПараметрыЗаполнения = Новый Структура("Основание");
	
	ДанныеЗаполнения = Новый Структура;
	ДанныеЗаполнения.Вставить("Действие", "ЗаполнитьПоПараметрамЗаполнения");
	ДанныеЗаполнения.Вставить("ДатаНачала", 			Объект.ДатаНачала);
	ДанныеЗаполнения.Вставить("ДатаНачалаОплаты", 		Объект.ДатаНачала);
	ДанныеЗаполнения.Вставить("ДатаОкончания", 			Объект.ДатаОкончания);
	ДанныеЗаполнения.Вставить("ДатаОкончанияОплаты", 	Объект.ДатаОкончания);
	ДанныеЗаполнения.Вставить("Организация", 			Объект.Организация);
	ДанныеЗаполнения.Вставить("Сотрудник", 				Объект.Сотрудник);
	
	ПериодРасчетаСреднего = УчетПособийСоциальногоСтрахованияКлиентСервер.ПериодРасчетаСреднегоЗаработкаФСС(Объект.ДатаНачала);
	ДанныеЗаполнения.Вставить("ПериодРасчетаСреднегоЗаработкаПервыйГод", Год(ПериодРасчетаСреднего.ДатаНачала));
	ДанныеЗаполнения.Вставить("ПериодРасчетаСреднегоЗаработкаВторойГод", Год(ПериодРасчетаСреднего.ДатаОкончания));
	
	Если ЗначениеЗаполнено(ПричинаНетрудоспособности) Тогда
		ДанныеЗаполнения.Вставить("ПричинаНетрудоспособности", ПричинаНетрудоспособности);
	КонецЕсли;
		
	ПараметрыЗаполнения.Основание = ДанныеЗаполнения;
		
	Возврат ПараметрыЗаполнения;
	
КонецФункции

Функция ЗначенияДляВыбораДокументаПоОтсутствию(Форма) Экспорт

Объект = Форма.Объект;
	Отбор = Новый Структура;
	
	Если Объект.ПричинаОтсутствия = ПредопределенноеЗначение("Перечисление.ПричиныОтсутствийЗаявокКабинетСотрудника.Болезнь") Тогда
		Отбор.Вставить("Организация", Объект.Организация);
		Отбор.Вставить("Сотрудник", Объект.Сотрудник);
	ИначеЕсли Объект.ПричинаОтсутствия = ПредопределенноеЗначение("Перечисление.ПричиныОтсутствийЗаявокКабинетСотрудника.ОтпускПоБеременностиИРодам") Тогда
		Отбор.Вставить("Организация", Объект.Организация);
		Отбор.Вставить("Сотрудник", Объект.Сотрудник);
	КонецЕсли;
	
	ЗначенияДляВыбора = ЗаявкиСотрудниковВызовСервераБазовый.ЗначенияДляВыбораДокументаПоОтсутствию(Объект.ПричинаОтсутствия);
	
	Возврат Новый Структура("Отбор,ЗначенияДляВыбораВидаДокумента", Отбор, ЗначенияДляВыбора)

КонецФункции

#КонецОбласти