#Область ОбработчикиСобытий

&НаКлиенте
Процедура ОбработкаКоманды(ПараметрКоманды, ПараметрыВыполненияКоманды)
	
	Если ПоказыватьСписокЗаявок() Тогда
		ОткрытьФорму("Документ.ЗаявкаНаДепозитОбменСБанками.Форма.ФормаСписка");
	Иначе
		ОткрытьФорму("Документ.ЗаявкаНаДепозитОбменСБанками.Форма.ФормаДокумента",
				,
				ПараметрыВыполненияКоманды.Источник,
				,
				ПараметрыВыполненияКоманды.Окно, 
				ПараметрыВыполненияКоманды.НавигационнаяСсылка);
	КонецЕсли;
	
КонецПроцедуры

&НаСервере
Функция ПоказыватьСписокЗаявок()
	
	Если Не ОбменСБанкамиДепозитыСлужебный.ЕстьПоддержкаДепозитов() Тогда
		Возврат Истина;
	КонецЕсли;
	
	Запрос = Новый Запрос;
	Запрос.Текст =
	"ВЫБРАТЬ Первые 1
	|	ЗаявкаНаДепозитОбменСБанками.Ссылка
	|ИЗ
	|	Документ.ЗаявкаНаДепозитОбменСБанками КАК ЗаявкаНаДепозитОбменСБанками
	|ГДЕ
	|	ЗаявкаНаДепозитОбменСБанками.ПометкаУдаления = ЛОЖЬ
	|	И ЗаявкаНаДепозитОбменСБанками.Дата >= &Дата";
	ПериодПросмотра = 7 * 24 * 60 * 60;
	Запрос.УстановитьПараметр("Дата", НачалоДня(ТекущаяДатаСеанса()) - ПериодПросмотра);
	РезультатЗапроса = Запрос.Выполнить();
	
	Возврат Не РезультатЗапроса.Пустой();
	
КонецФункции

#КонецОбласти

